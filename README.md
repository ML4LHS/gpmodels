
<!-- README.md is generated from README.Rmd. Please edit that file -->

# wizard

## Windowed Summarization for Autoregressive Data

This package uses windowed summarization to convert time series data
into a form that can be modeled by prediction models.

<!-- badges: start -->

<!-- badges: end -->

## Installation

You can install the GitHub version of wizard with:

``` r
remotes::install_github('ML4LHS/wizard')
#> Using github PAT from envvar GITHUB_PAT
#> Skipping install of 'wizard' from a github remote, the SHA1 (d29702d0) has not changed since last install.
#>   Use `force = TRUE` to force installation
```

## How to set up a wiz\_frame()

Start by loading and package and defining your `wiz_frame()`. A
`wiz_frame` is simply a list with the class `wiz_frame` and contains all
the key information needed to describe both your fixed dataset (such as
demographics, one row per patient) and your temporal dataset (one row
per observation linked to a timestamp).

``` r
library(wizard)
library(magrittr)
library(lubridate)

unlink(file.path(tempdir(), 'wiz_frame_dir', '*.*'))

wf = wiz_frame(fixed_data = sample_fixed_data,
               temporal_data = sample_temporal_data %>% dplyr::filter(id %in% 1:2),
               fixed_id = 'id',
               fixed_start = 'admit_time',
               temporal_id = 'id',
               temporal_time = 'time',
               temporal_variable = 'variable',
               temporal_category = 'category',
               temporal_value = 'value',
               step = lubridate::hours(6),
               output_folder = file.path(tempdir(), 'wiz_frame_dir'))
```

## Let’s look at the automatically generated data dictionaries

``` r
wf$fixed_data_dict
#>      variable     class
#> 1          id   integer
#> 2         sex character
#> 3         age   numeric
#> 4        race character
#> 5 baseline_cr   numeric
#> 6  admit_time   POSIXct

wf$temporal_data_dict
#>         variable   class
#> 1             cr numeric
#> 2 cr_abnl_normal numeric
#> 3   cr_abnl_high numeric
#> 4     cr_high_no numeric
#> 5    cr_high_yes numeric
```

## Let’s add some predictors and outcomes

The default method writes output to the folder defined in your
`wiz_frame`. When you write your output to file, you are allowed to
chain together `add_predictors()` and `add_outcomes()` functions. This
is possble because these functions invisibly return a `wiz_frame`.

If, however, you set `output_file` to `FALSE`, then your actual output
is returned (rather than the `wiz_frame`) so you cannot chain functions.

``` r
wf %>% 
  wiz_add_predictors(variable = 'cr', # Note: You can supply a vector of variables
                     lookback = hours(12), 
                     window = hours(6), 
                     stats = c(mean = mean,
                               min = min,
                               max = max,
                               median = median,
                               length = length)) %>% 
  wiz_add_predictors(category = 'flag', # Note: category is always a regular expression 
                     lookback = days(7),
                     stats = c(sum = sum,
                               any = any)) %>% 
  wiz_add_outcomes(variable = 'cr',
                   lookahead = hours(24), 
                   stats = c(max = max))
#> Processing variable cr...
#> Anticipated number of rows in intermediate output: 212
#> Anticipated number of rows in final output: 106
#> [==>-------------------------------------------------------------------------] 7/212 (  3%) Time remaining:  6s[==>-------------------------------------------------------------------------] 8/212 (  4%) Time remaining:  6s[==>-------------------------------------------------------------------------] 9/212 (  4%) Time remaining:  5s[===>-----------------------------------------------------------------------] 10/212 (  5%) Time remaining:  5s[===>-----------------------------------------------------------------------] 11/212 (  5%) Time remaining:  5s[===>-----------------------------------------------------------------------] 12/212 (  6%) Time remaining:  5s[====>----------------------------------------------------------------------] 13/212 (  6%) Time remaining:  5s[====>----------------------------------------------------------------------] 14/212 (  7%) Time remaining:  5s[====>----------------------------------------------------------------------] 15/212 (  7%) Time remaining:  4s[=====>---------------------------------------------------------------------] 16/212 (  8%) Time remaining:  4s[=====>---------------------------------------------------------------------] 17/212 (  8%) Time remaining:  4s[=====>---------------------------------------------------------------------] 18/212 (  8%) Time remaining:  4s[======>--------------------------------------------------------------------] 19/212 (  9%) Time remaining:  4s[======>--------------------------------------------------------------------] 20/212 (  9%) Time remaining:  4s[======>--------------------------------------------------------------------] 21/212 ( 10%) Time remaining:  4s[=======>-------------------------------------------------------------------] 22/212 ( 10%) Time remaining:  4s[=======>-------------------------------------------------------------------] 23/212 ( 11%) Time remaining:  4s[=======>-------------------------------------------------------------------] 24/212 ( 11%) Time remaining:  4s[========>------------------------------------------------------------------] 25/212 ( 12%) Time remaining:  4s[========>------------------------------------------------------------------] 26/212 ( 12%) Time remaining:  4s[=========>-----------------------------------------------------------------] 27/212 ( 13%) Time remaining:  4s[=========>-----------------------------------------------------------------] 28/212 ( 13%) Time remaining:  4s[=========>-----------------------------------------------------------------] 29/212 ( 14%) Time remaining:  4s[==========>----------------------------------------------------------------] 30/212 ( 14%) Time remaining:  4s[==========>----------------------------------------------------------------] 31/212 ( 15%) Time remaining:  4s[==========>----------------------------------------------------------------] 32/212 ( 15%) Time remaining:  4s[===========>---------------------------------------------------------------] 33/212 ( 16%) Time remaining:  4s[===========>---------------------------------------------------------------] 34/212 ( 16%) Time remaining:  4s[===========>---------------------------------------------------------------] 35/212 ( 17%) Time remaining:  3s[============>--------------------------------------------------------------] 36/212 ( 17%) Time remaining:  3s[============>--------------------------------------------------------------] 37/212 ( 17%) Time remaining:  3s[============>--------------------------------------------------------------] 38/212 ( 18%) Time remaining:  3s[=============>-------------------------------------------------------------] 39/212 ( 18%) Time remaining:  3s[=============>-------------------------------------------------------------] 40/212 ( 19%) Time remaining:  3s[==============>------------------------------------------------------------] 41/212 ( 19%) Time remaining:  3s[==============>------------------------------------------------------------] 42/212 ( 20%) Time remaining:  3s[==============>------------------------------------------------------------] 43/212 ( 20%) Time remaining:  3s[===============>-----------------------------------------------------------] 44/212 ( 21%) Time remaining:  3s[===============>-----------------------------------------------------------] 45/212 ( 21%) Time remaining:  3s[===============>-----------------------------------------------------------] 46/212 ( 22%) Time remaining:  3s[================>----------------------------------------------------------] 47/212 ( 22%) Time remaining:  3s[================>----------------------------------------------------------] 48/212 ( 23%) Time remaining:  3s[================>----------------------------------------------------------] 49/212 ( 23%) Time remaining:  3s[=================>---------------------------------------------------------] 50/212 ( 24%) Time remaining:  3s[=================>---------------------------------------------------------] 51/212 ( 24%) Time remaining:  3s[=================>---------------------------------------------------------] 52/212 ( 25%) Time remaining:  3s[==================>--------------------------------------------------------] 53/212 ( 25%) Time remaining:  3s[==================>--------------------------------------------------------] 54/212 ( 25%) Time remaining:  3s[==================>--------------------------------------------------------] 55/212 ( 26%) Time remaining:  3s[===================>-------------------------------------------------------] 56/212 ( 26%) Time remaining:  3s[===================>-------------------------------------------------------] 57/212 ( 27%) Time remaining:  3s[====================>------------------------------------------------------] 58/212 ( 27%) Time remaining:  3s[====================>------------------------------------------------------] 59/212 ( 28%) Time remaining:  3s[====================>------------------------------------------------------] 60/212 ( 28%) Time remaining:  3s[=====================>-----------------------------------------------------] 61/212 ( 29%) Time remaining:  3s[=====================>-----------------------------------------------------] 62/212 ( 29%) Time remaining:  3s[=====================>-----------------------------------------------------] 63/212 ( 30%) Time remaining:  3s[======================>----------------------------------------------------] 64/212 ( 30%) Time remaining:  3s[======================>----------------------------------------------------] 65/212 ( 31%) Time remaining:  3s[======================>----------------------------------------------------] 66/212 ( 31%) Time remaining:  3s[=======================>---------------------------------------------------] 67/212 ( 32%) Time remaining:  3s[=======================>---------------------------------------------------] 68/212 ( 32%) Time remaining:  3s[=======================>---------------------------------------------------] 69/212 ( 33%) Time remaining:  3s[========================>--------------------------------------------------] 70/212 ( 33%) Time remaining:  3s[========================>--------------------------------------------------] 71/212 ( 33%) Time remaining:  3s[========================>--------------------------------------------------] 72/212 ( 34%) Time remaining:  3s[=========================>-------------------------------------------------] 73/212 ( 34%) Time remaining:  3s[=========================>-------------------------------------------------] 74/212 ( 35%) Time remaining:  3s[==========================>------------------------------------------------] 75/212 ( 35%) Time remaining:  3s[==========================>------------------------------------------------] 76/212 ( 36%) Time remaining:  3s[==========================>------------------------------------------------] 77/212 ( 36%) Time remaining:  2s[===========================>-----------------------------------------------] 78/212 ( 37%) Time remaining:  2s[===========================>-----------------------------------------------] 79/212 ( 37%) Time remaining:  2s[===========================>-----------------------------------------------] 80/212 ( 38%) Time remaining:  2s[============================>----------------------------------------------] 81/212 ( 38%) Time remaining:  2s[============================>----------------------------------------------] 82/212 ( 39%) Time remaining:  2s[============================>----------------------------------------------] 83/212 ( 39%) Time remaining:  2s[=============================>---------------------------------------------] 84/212 ( 40%) Time remaining:  2s[=============================>---------------------------------------------] 85/212 ( 40%) Time remaining:  2s[=============================>---------------------------------------------] 86/212 ( 41%) Time remaining:  2s[==============================>--------------------------------------------] 87/212 ( 41%) Time remaining:  2s[==============================>--------------------------------------------] 88/212 ( 42%) Time remaining:  2s[==============================>--------------------------------------------] 89/212 ( 42%) Time remaining:  2s[===============================>-------------------------------------------] 90/212 ( 42%) Time remaining:  2s[===============================>-------------------------------------------] 91/212 ( 43%) Time remaining:  2s[================================>------------------------------------------] 92/212 ( 43%) Time remaining:  2s[================================>------------------------------------------] 93/212 ( 44%) Time remaining:  2s[================================>------------------------------------------] 94/212 ( 44%) Time remaining:  2s[=================================>-----------------------------------------] 95/212 ( 45%) Time remaining:  2s[=================================>-----------------------------------------] 96/212 ( 45%) Time remaining:  2s[=================================>-----------------------------------------] 97/212 ( 46%) Time remaining:  2s[==================================>----------------------------------------] 98/212 ( 46%) Time remaining:  2s[==================================>----------------------------------------] 99/212 ( 47%) Time remaining:  2s[==================================>---------------------------------------] 100/212 ( 47%) Time remaining:  2s[==================================>---------------------------------------] 101/212 ( 48%) Time remaining:  2s[===================================>--------------------------------------] 102/212 ( 48%) Time remaining:  2s[===================================>--------------------------------------] 103/212 ( 49%) Time remaining:  2s[===================================>--------------------------------------] 104/212 ( 49%) Time remaining:  2s[====================================>-------------------------------------] 105/212 ( 50%) Time remaining:  2s[====================================>-------------------------------------] 106/212 ( 50%) Time remaining:  2s[====================================>-------------------------------------] 107/212 ( 50%) Time remaining:  2s[=====================================>------------------------------------] 108/212 ( 51%) Time remaining:  2s[=====================================>------------------------------------] 109/212 ( 51%) Time remaining:  2s[=====================================>------------------------------------] 110/212 ( 52%) Time remaining:  2s[======================================>-----------------------------------] 111/212 ( 52%) Time remaining:  2s[======================================>-----------------------------------] 112/212 ( 53%) Time remaining:  2s[======================================>-----------------------------------] 113/212 ( 53%) Time remaining:  2s[=======================================>----------------------------------] 114/212 ( 54%) Time remaining:  2s[=======================================>----------------------------------] 115/212 ( 54%) Time remaining:  2s[=======================================>----------------------------------] 116/212 ( 55%) Time remaining:  2s[========================================>---------------------------------] 117/212 ( 55%) Time remaining:  2s[========================================>---------------------------------] 118/212 ( 56%) Time remaining:  2s[=========================================>--------------------------------] 119/212 ( 56%) Time remaining:  2s[=========================================>--------------------------------] 120/212 ( 57%) Time remaining:  2s[=========================================>--------------------------------] 121/212 ( 57%) Time remaining:  2s[==========================================>-------------------------------] 122/212 ( 58%) Time remaining:  2s[==========================================>-------------------------------] 123/212 ( 58%) Time remaining:  2s[==========================================>-------------------------------] 124/212 ( 58%) Time remaining:  2s[===========================================>------------------------------] 125/212 ( 59%) Time remaining:  2s[===========================================>------------------------------] 126/212 ( 59%) Time remaining:  2s[===========================================>------------------------------] 127/212 ( 60%) Time remaining:  2s[============================================>-----------------------------] 128/212 ( 60%) Time remaining:  2s[============================================>-----------------------------] 129/212 ( 61%) Time remaining:  1s[============================================>-----------------------------] 130/212 ( 61%) Time remaining:  1s[=============================================>----------------------------] 131/212 ( 62%) Time remaining:  1s[=============================================>----------------------------] 132/212 ( 62%) Time remaining:  1s[=============================================>----------------------------] 133/212 ( 63%) Time remaining:  1s[==============================================>---------------------------] 134/212 ( 63%) Time remaining:  1s[==============================================>---------------------------] 135/212 ( 64%) Time remaining:  1s[==============================================>---------------------------] 136/212 ( 64%) Time remaining:  1s[===============================================>--------------------------] 137/212 ( 65%) Time remaining:  1s[===============================================>--------------------------] 138/212 ( 65%) Time remaining:  1s[================================================>-------------------------] 139/212 ( 66%) Time remaining:  1s[================================================>-------------------------] 140/212 ( 66%) Time remaining:  1s[================================================>-------------------------] 141/212 ( 67%) Time remaining:  1s[=================================================>------------------------] 142/212 ( 67%) Time remaining:  1s[=================================================>------------------------] 143/212 ( 67%) Time remaining:  1s[=================================================>------------------------] 144/212 ( 68%) Time remaining:  1s[==================================================>-----------------------] 145/212 ( 68%) Time remaining:  1s[==================================================>-----------------------] 146/212 ( 69%) Time remaining:  1s[==================================================>-----------------------] 147/212 ( 69%) Time remaining:  1s[===================================================>----------------------] 148/212 ( 70%) Time remaining:  1s[===================================================>----------------------] 149/212 ( 70%) Time remaining:  1s[===================================================>----------------------] 150/212 ( 71%) Time remaining:  1s[====================================================>---------------------] 151/212 ( 71%) Time remaining:  1s[====================================================>---------------------] 152/212 ( 72%) Time remaining:  1s[====================================================>---------------------] 153/212 ( 72%) Time remaining:  1s[=====================================================>--------------------] 154/212 ( 73%) Time remaining:  1s[=====================================================>--------------------] 155/212 ( 73%) Time remaining:  1s[=====================================================>--------------------] 156/212 ( 74%) Time remaining:  1s[======================================================>-------------------] 157/212 ( 74%) Time remaining:  1s[======================================================>-------------------] 158/212 ( 75%) Time remaining:  1s[=======================================================>------------------] 159/212 ( 75%) Time remaining:  1s[=======================================================>------------------] 160/212 ( 75%) Time remaining:  1s[=======================================================>------------------] 161/212 ( 76%) Time remaining:  1s[========================================================>-----------------] 162/212 ( 76%) Time remaining:  1s[========================================================>-----------------] 163/212 ( 77%) Time remaining:  1s[========================================================>-----------------] 164/212 ( 77%) Time remaining:  1s[=========================================================>----------------] 165/212 ( 78%) Time remaining:  1s[=========================================================>----------------] 166/212 ( 78%) Time remaining:  1s[=========================================================>----------------] 167/212 ( 79%) Time remaining:  1s[==========================================================>---------------] 168/212 ( 79%) Time remaining:  1s[==========================================================>---------------] 169/212 ( 80%) Time remaining:  1s[==========================================================>---------------] 170/212 ( 80%) Time remaining:  1s[===========================================================>--------------] 171/212 ( 81%) Time remaining:  1s[===========================================================>--------------] 172/212 ( 81%) Time remaining:  1s[===========================================================>--------------] 173/212 ( 82%) Time remaining:  1s[============================================================>-------------] 174/212 ( 82%) Time remaining:  1s[============================================================>-------------] 175/212 ( 83%) Time remaining:  1s[============================================================>-------------] 176/212 ( 83%) Time remaining:  1s[=============================================================>------------] 177/212 ( 83%) Time remaining:  1s[=============================================================>------------] 178/212 ( 84%) Time remaining:  1s[=============================================================>------------] 179/212 ( 84%) Time remaining:  1s[==============================================================>-----------] 180/212 ( 85%) Time remaining:  1s[==============================================================>-----------] 181/212 ( 85%) Time remaining:  1s[===============================================================>----------] 182/212 ( 86%) Time remaining:  1s[===============================================================>----------] 183/212 ( 86%) Time remaining:  1s[===============================================================>----------] 184/212 ( 87%) Time remaining:  0s[================================================================>---------] 185/212 ( 87%) Time remaining:  0s[================================================================>---------] 186/212 ( 88%) Time remaining:  0s[================================================================>---------] 187/212 ( 88%) Time remaining:  0s[=================================================================>--------] 188/212 ( 89%) Time remaining:  0s[=================================================================>--------] 189/212 ( 89%) Time remaining:  0s[=================================================================>--------] 190/212 ( 90%) Time remaining:  0s[==================================================================>-------] 191/212 ( 90%) Time remaining:  0s[==================================================================>-------] 192/212 ( 91%) Time remaining:  0s[==================================================================>-------] 193/212 ( 91%) Time remaining:  0s[===================================================================>------] 194/212 ( 92%) Time remaining:  0s[===================================================================>------] 195/212 ( 92%) Time remaining:  0s[===================================================================>------] 196/212 ( 92%) Time remaining:  0s[====================================================================>-----] 197/212 ( 93%) Time remaining:  0s[====================================================================>-----] 198/212 ( 93%) Time remaining:  0s[====================================================================>-----] 199/212 ( 94%) Time remaining:  0s[=====================================================================>----] 200/212 ( 94%) Time remaining:  0s[=====================================================================>----] 201/212 ( 95%) Time remaining:  0s[======================================================================>---] 202/212 ( 95%) Time remaining:  0s[======================================================================>---] 203/212 ( 96%) Time remaining:  0s[======================================================================>---] 204/212 ( 96%) Time remaining:  0s[=======================================================================>--] 205/212 ( 97%) Time remaining:  0s[=======================================================================>--] 206/212 ( 97%) Time remaining:  0s[=======================================================================>--] 207/212 ( 98%) Time remaining:  0s[========================================================================>-] 208/212 ( 98%) Time remaining:  0s[========================================================================>-] 209/212 ( 99%) Time remaining:  0s[========================================================================>-] 210/212 ( 99%) Time remaining:  0s[=========================================================================>] 211/212 (100%) Time remaining:  0s[==========================================================================] 212/212 (100%) Time remaining:  0s                                                                                                               The output file was written to: C:\Users\kdpsingh\AppData\Local\Temp\8\RtmpQz6JZV/wiz_frame_dir/temporal_predictors_variable_cr_2020_09_26_05_09_42.csv
#> Processing category flag...
#> Anticipated number of rows in intermediate output: 106
#> Anticipated number of rows in final output: 106
#> [=>-------------------------------------------------------------------------] 12/424 (  3%) Time remaining:  7s[=>-------------------------------------------------------------------------] 13/424 (  3%) Time remaining:  7s[=>-------------------------------------------------------------------------] 14/424 (  3%) Time remaining:  7s[==>------------------------------------------------------------------------] 15/424 (  4%) Time remaining:  7s[==>------------------------------------------------------------------------] 16/424 (  4%) Time remaining:  7s[==>------------------------------------------------------------------------] 17/424 (  4%) Time remaining:  7s[==>------------------------------------------------------------------------] 18/424 (  4%) Time remaining:  7s[==>------------------------------------------------------------------------] 19/424 (  4%) Time remaining:  7s[===>-----------------------------------------------------------------------] 20/424 (  5%) Time remaining:  6s[===>-----------------------------------------------------------------------] 21/424 (  5%) Time remaining:  6s[===>-----------------------------------------------------------------------] 22/424 (  5%) Time remaining:  6s[===>-----------------------------------------------------------------------] 23/424 (  5%) Time remaining:  6s[===>-----------------------------------------------------------------------] 24/424 (  6%) Time remaining:  6s[===>-----------------------------------------------------------------------] 25/424 (  6%) Time remaining:  6s[====>----------------------------------------------------------------------] 26/424 (  6%) Time remaining:  6s[====>----------------------------------------------------------------------] 27/424 (  6%) Time remaining:  6s[====>----------------------------------------------------------------------] 28/424 (  7%) Time remaining:  6s[====>----------------------------------------------------------------------] 29/424 (  7%) Time remaining:  6s[====>----------------------------------------------------------------------] 30/424 (  7%) Time remaining:  6s[====>----------------------------------------------------------------------] 31/424 (  7%) Time remaining:  6s[=====>---------------------------------------------------------------------] 32/424 (  8%) Time remaining:  6s[=====>---------------------------------------------------------------------] 33/424 (  8%) Time remaining:  6s[=====>---------------------------------------------------------------------] 34/424 (  8%) Time remaining:  6s[=====>---------------------------------------------------------------------] 35/424 (  8%) Time remaining:  6s[=====>---------------------------------------------------------------------] 36/424 (  8%) Time remaining:  6s[======>--------------------------------------------------------------------] 37/424 (  9%) Time remaining:  6s[======>--------------------------------------------------------------------] 38/424 (  9%) Time remaining:  6s[======>--------------------------------------------------------------------] 39/424 (  9%) Time remaining:  6s[======>--------------------------------------------------------------------] 40/424 (  9%) Time remaining:  6s[======>--------------------------------------------------------------------] 41/424 ( 10%) Time remaining:  6s[======>--------------------------------------------------------------------] 42/424 ( 10%) Time remaining:  6s[=======>-------------------------------------------------------------------] 43/424 ( 10%) Time remaining:  6s[=======>-------------------------------------------------------------------] 44/424 ( 10%) Time remaining:  6s[=======>-------------------------------------------------------------------] 45/424 ( 11%) Time remaining:  6s[=======>-------------------------------------------------------------------] 46/424 ( 11%) Time remaining:  6s[=======>-------------------------------------------------------------------] 47/424 ( 11%) Time remaining:  6s[=======>-------------------------------------------------------------------] 48/424 ( 11%) Time remaining:  6s[========>------------------------------------------------------------------] 49/424 ( 12%) Time remaining:  6s[========>------------------------------------------------------------------] 50/424 ( 12%) Time remaining:  6s[========>------------------------------------------------------------------] 51/424 ( 12%) Time remaining:  6s[========>------------------------------------------------------------------] 52/424 ( 12%) Time remaining:  6s[========>------------------------------------------------------------------] 53/424 ( 12%) Time remaining:  6s[=========>-----------------------------------------------------------------] 54/424 ( 13%) Time remaining:  6s[=========>-----------------------------------------------------------------] 55/424 ( 13%) Time remaining:  6s[=========>-----------------------------------------------------------------] 56/424 ( 13%) Time remaining:  6s[=========>-----------------------------------------------------------------] 57/424 ( 13%) Time remaining:  6s[=========>-----------------------------------------------------------------] 58/424 ( 14%) Time remaining:  6s[=========>-----------------------------------------------------------------] 59/424 ( 14%) Time remaining:  6s[==========>----------------------------------------------------------------] 60/424 ( 14%) Time remaining:  6s[==========>----------------------------------------------------------------] 61/424 ( 14%) Time remaining:  6s[==========>----------------------------------------------------------------] 62/424 ( 15%) Time remaining:  6s[==========>----------------------------------------------------------------] 63/424 ( 15%) Time remaining:  6s[==========>----------------------------------------------------------------] 64/424 ( 15%) Time remaining:  6s[==========>----------------------------------------------------------------] 65/424 ( 15%) Time remaining:  6s[===========>---------------------------------------------------------------] 66/424 ( 16%) Time remaining:  6s[===========>---------------------------------------------------------------] 67/424 ( 16%) Time remaining:  6s[===========>---------------------------------------------------------------] 68/424 ( 16%) Time remaining:  6s[===========>---------------------------------------------------------------] 69/424 ( 16%) Time remaining:  6s[===========>---------------------------------------------------------------] 70/424 ( 17%) Time remaining:  6s[============>--------------------------------------------------------------] 71/424 ( 17%) Time remaining:  6s[============>--------------------------------------------------------------] 72/424 ( 17%) Time remaining:  6s[============>--------------------------------------------------------------] 73/424 ( 17%) Time remaining:  6s[============>--------------------------------------------------------------] 74/424 ( 17%) Time remaining:  6s[============>--------------------------------------------------------------] 75/424 ( 18%) Time remaining:  6s[============>--------------------------------------------------------------] 76/424 ( 18%) Time remaining:  6s[=============>-------------------------------------------------------------] 77/424 ( 18%) Time remaining:  6s[=============>-------------------------------------------------------------] 78/424 ( 18%) Time remaining:  6s[=============>-------------------------------------------------------------] 79/424 ( 19%) Time remaining:  6s[=============>-------------------------------------------------------------] 80/424 ( 19%) Time remaining:  6s[=============>-------------------------------------------------------------] 81/424 ( 19%) Time remaining:  6s[==============>------------------------------------------------------------] 82/424 ( 19%) Time remaining:  5s[==============>------------------------------------------------------------] 83/424 ( 20%) Time remaining:  6s[==============>------------------------------------------------------------] 84/424 ( 20%) Time remaining:  6s[==============>------------------------------------------------------------] 85/424 ( 20%) Time remaining:  6s[==============>------------------------------------------------------------] 86/424 ( 20%) Time remaining:  5s[==============>------------------------------------------------------------] 87/424 ( 21%) Time remaining:  5s[===============>-----------------------------------------------------------] 88/424 ( 21%) Time remaining:  5s[===============>-----------------------------------------------------------] 89/424 ( 21%) Time remaining:  5s[===============>-----------------------------------------------------------] 90/424 ( 21%) Time remaining:  5s[===============>-----------------------------------------------------------] 91/424 ( 21%) Time remaining:  5s[===============>-----------------------------------------------------------] 92/424 ( 22%) Time remaining:  5s[===============>-----------------------------------------------------------] 93/424 ( 22%) Time remaining:  5s[================>----------------------------------------------------------] 94/424 ( 22%) Time remaining:  5s[================>----------------------------------------------------------] 95/424 ( 22%) Time remaining:  5s[================>----------------------------------------------------------] 96/424 ( 23%) Time remaining:  5s[================>----------------------------------------------------------] 97/424 ( 23%) Time remaining:  5s[================>----------------------------------------------------------] 98/424 ( 23%) Time remaining:  5s[=================>---------------------------------------------------------] 99/424 ( 23%) Time remaining:  5s[================>---------------------------------------------------------] 100/424 ( 24%) Time remaining:  5s[=================>--------------------------------------------------------] 101/424 ( 24%) Time remaining:  5s[=================>--------------------------------------------------------] 102/424 ( 24%) Time remaining:  5s[=================>--------------------------------------------------------] 103/424 ( 24%) Time remaining:  5s[=================>--------------------------------------------------------] 104/424 ( 25%) Time remaining:  5s[=================>--------------------------------------------------------] 105/424 ( 25%) Time remaining:  5s[=================>--------------------------------------------------------] 106/424 ( 25%) Time remaining:  5sThe output file was written to: C:\Users\kdpsingh\AppData\Local\Temp\8\RtmpQz6JZV/wiz_frame_dir/temporal_predictors_category_flag_2020_09_26_05_09_44.csv
#> Processing variable cr...
#> Anticipated number of rows in intermediate output: 106
#> Anticipated number of rows in final output: 106
#> [==========>----------------------------------------------------------------] 15/106 ( 14%) Time remaining:  1s[==========>----------------------------------------------------------------] 16/106 ( 15%) Time remaining:  1s[===========>---------------------------------------------------------------] 17/106 ( 16%) Time remaining:  1s[============>--------------------------------------------------------------] 18/106 ( 17%) Time remaining:  1s[============>--------------------------------------------------------------] 19/106 ( 18%) Time remaining:  1s[=============>-------------------------------------------------------------] 20/106 ( 19%) Time remaining:  1s[==============>------------------------------------------------------------] 21/106 ( 20%) Time remaining:  1s[===============>-----------------------------------------------------------] 22/106 ( 21%) Time remaining:  1s[===============>-----------------------------------------------------------] 23/106 ( 22%) Time remaining:  1s[================>----------------------------------------------------------] 24/106 ( 23%) Time remaining:  1s[=================>---------------------------------------------------------] 25/106 ( 24%) Time remaining:  1s[=================>---------------------------------------------------------] 26/106 ( 25%) Time remaining:  1s[==================>--------------------------------------------------------] 27/106 ( 25%) Time remaining:  1s[===================>-------------------------------------------------------] 28/106 ( 26%) Time remaining:  1s[====================>------------------------------------------------------] 29/106 ( 27%) Time remaining:  1s[====================>------------------------------------------------------] 30/106 ( 28%) Time remaining:  1s[=====================>-----------------------------------------------------] 31/106 ( 29%) Time remaining:  1s[======================>----------------------------------------------------] 32/106 ( 30%) Time remaining:  1s[======================>----------------------------------------------------] 33/106 ( 31%) Time remaining:  1s[=======================>---------------------------------------------------] 34/106 ( 32%) Time remaining:  1s[========================>--------------------------------------------------] 35/106 ( 33%) Time remaining:  1s[========================>--------------------------------------------------] 36/106 ( 34%) Time remaining:  1s[=========================>-------------------------------------------------] 37/106 ( 35%) Time remaining:  1s[==========================>------------------------------------------------] 38/106 ( 36%) Time remaining:  1s[===========================>-----------------------------------------------] 39/106 ( 37%) Time remaining:  1s[===========================>-----------------------------------------------] 40/106 ( 38%) Time remaining:  1s[============================>----------------------------------------------] 41/106 ( 39%) Time remaining:  1s[=============================>---------------------------------------------] 42/106 ( 40%) Time remaining:  1s[=============================>---------------------------------------------] 43/106 ( 41%) Time remaining:  1s[==============================>--------------------------------------------] 44/106 ( 42%) Time remaining:  1s[===============================>-------------------------------------------] 45/106 ( 42%) Time remaining:  1s[================================>------------------------------------------] 46/106 ( 43%) Time remaining:  1s[================================>------------------------------------------] 47/106 ( 44%) Time remaining:  1s[=================================>-----------------------------------------] 48/106 ( 45%) Time remaining:  1s[==================================>----------------------------------------] 49/106 ( 46%) Time remaining:  1s[==================================>----------------------------------------] 50/106 ( 47%) Time remaining:  1s[===================================>---------------------------------------] 51/106 ( 48%) Time remaining:  1s[====================================>--------------------------------------] 52/106 ( 49%) Time remaining:  1s[=====================================>-------------------------------------] 53/106 ( 50%) Time remaining:  1s[=====================================>-------------------------------------] 54/106 ( 51%) Time remaining:  1s[======================================>------------------------------------] 55/106 ( 52%) Time remaining:  1s[=======================================>-----------------------------------] 56/106 ( 53%) Time remaining:  1s[=======================================>-----------------------------------] 57/106 ( 54%) Time remaining:  1s[========================================>----------------------------------] 58/106 ( 55%) Time remaining:  1s[=========================================>---------------------------------] 59/106 ( 56%) Time remaining:  1s[=========================================>---------------------------------] 60/106 ( 57%) Time remaining:  1s[==========================================>--------------------------------] 61/106 ( 58%) Time remaining:  1s[===========================================>-------------------------------] 62/106 ( 58%) Time remaining:  1s[============================================>------------------------------] 63/106 ( 59%) Time remaining:  1s[============================================>------------------------------] 64/106 ( 60%) Time remaining:  1s[=============================================>-----------------------------] 65/106 ( 61%) Time remaining:  1s[==============================================>----------------------------] 66/106 ( 62%) Time remaining:  1s[==============================================>----------------------------] 67/106 ( 63%) Time remaining:  1s[===============================================>---------------------------] 68/106 ( 64%) Time remaining:  1s[================================================>--------------------------] 69/106 ( 65%) Time remaining:  1s[=================================================>-------------------------] 70/106 ( 66%) Time remaining:  1s[=================================================>-------------------------] 71/106 ( 67%) Time remaining:  1s[==================================================>------------------------] 72/106 ( 68%) Time remaining:  1s[===================================================>-----------------------] 73/106 ( 69%) Time remaining:  0s[===================================================>-----------------------] 74/106 ( 70%) Time remaining:  0s[====================================================>----------------------] 75/106 ( 71%) Time remaining:  0s[=====================================================>---------------------] 76/106 ( 72%) Time remaining:  0s[=====================================================>---------------------] 77/106 ( 73%) Time remaining:  0s[======================================================>--------------------] 78/106 ( 74%) Time remaining:  0s[=======================================================>-------------------] 79/106 ( 75%) Time remaining:  0s[========================================================>------------------] 80/106 ( 75%) Time remaining:  0s[========================================================>------------------] 81/106 ( 76%) Time remaining:  0s[=========================================================>-----------------] 82/106 ( 77%) Time remaining:  0s[==========================================================>----------------] 83/106 ( 78%) Time remaining:  0s[==========================================================>----------------] 84/106 ( 79%) Time remaining:  0s[===========================================================>---------------] 85/106 ( 80%) Time remaining:  0s[============================================================>--------------] 86/106 ( 81%) Time remaining:  0s[=============================================================>-------------] 87/106 ( 82%) Time remaining:  0s[=============================================================>-------------] 88/106 ( 83%) Time remaining:  0s[==============================================================>------------] 89/106 ( 84%) Time remaining:  0s[===============================================================>-----------] 90/106 ( 85%) Time remaining:  0s[===============================================================>-----------] 91/106 ( 86%) Time remaining:  0s[================================================================>----------] 92/106 ( 87%) Time remaining:  0s[=================================================================>---------] 93/106 ( 88%) Time remaining:  0s[==================================================================>--------] 94/106 ( 89%) Time remaining:  0s[==================================================================>--------] 95/106 ( 90%) Time remaining:  0s[===================================================================>-------] 96/106 ( 91%) Time remaining:  0s[====================================================================>------] 97/106 ( 92%) Time remaining:  0s[====================================================================>------] 98/106 ( 92%) Time remaining:  0s[=====================================================================>-----] 99/106 ( 93%) Time remaining:  0s[=====================================================================>----] 100/106 ( 94%) Time remaining:  0s[======================================================================>---] 101/106 ( 95%) Time remaining:  0s[======================================================================>---] 102/106 ( 96%) Time remaining:  0s[=======================================================================>--] 103/106 ( 97%) Time remaining:  0s[========================================================================>-] 104/106 ( 98%) Time remaining:  0s[========================================================================>-] 105/106 ( 99%) Time remaining:  0s[==========================================================================] 106/106 (100%) Time remaining:  0s                                                                                                               The output file was written to: C:\Users\kdpsingh\AppData\Local\Temp\8\RtmpQz6JZV/wiz_frame_dir/temporal_outcomes_variable_cr_2020_09_26_05_09_45.csv
```

## Let’s combine our output into a single data frame

You can either provide `wiz_combine()` with a set of data frames or
files separated by commas. Or, now you can provide a vector of file
names using the `files` argument.

This resulting frame is essentially ready for modeling (using
`tidymodels`, for example). Make sure to keep individual patients in the
same fold if you divide this dataset into multiple
folds.

``` r
model_data = wiz_combine(wf, files = dir(file.path(tempdir(), 'wiz_frame_dir')))
#> Joining, by = "id"
#> Joining, by = c("id", "time")
#> Joining, by = c("id", "time")

model_data
#>    id  sex      age  race baseline_cr          admit_time time outcome_cr_max_24 cr_abnl_high_any_168
#> 1   1 male 66.15955 asian    1.001175 2019-06-02 00:49:23    0          1.263829                   NA
#> 2   1 male 66.15955 asian    1.001175 2019-06-02 00:49:23    6          1.214161                   NA
#> 3   1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   12          1.214161                   NA
#> 4   1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   18          1.214161                   NA
#> 5   1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   24          1.201832                   NA
#> 6   1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   30          1.201832                   NA
#> 7   1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   36          1.201832                   NA
#> 8   1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   42          1.240844                   NA
#> 9   1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   48          1.240844                   NA
#> 10  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   54          1.277012                   NA
#> 11  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   60          1.277012                   NA
#> 12  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   66          1.277012                   NA
#> 13  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   72          1.277012                   NA
#> 14  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   78          1.163702                   NA
#> 15  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   84          1.163702                   NA
#> 16  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   90          1.163702                   NA
#> 17  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23   96          1.163702                   NA
#> 18  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  102          1.147976                   NA
#> 19  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  108          1.147976                   NA
#> 20  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  114          1.168626                   NA
#> 21  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  120          1.168626                   NA
#> 22  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  126          1.372001                   NA
#> 23  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  132          1.372001                   NA
#> 24  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  138          1.372001                   NA
#> 25  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  144          1.372001                   NA
#> 26  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  150          1.182934                    1
#> 27  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  156          1.182934                    1
#> 28  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  162          1.182150                    1
#> 29  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  168          1.230213                    1
#> 30  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  174          1.247080                    1
#> 31  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  180          1.247080                    1
#> 32  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  186          1.247080                    1
#> 33  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  192          1.247080                    1
#> 34  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  198          1.167717                    1
#> 35  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  204          1.167717                    1
#> 36  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  210          1.167717                    1
#> 37  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  216          1.140493                    1
#> 38  1 male 66.15955 asian    1.001175 2019-06-02 00:49:23  222          1.140493                    1
#>    cr_abnl_high_sum_168 cr_abnl_normal_any_168 cr_abnl_normal_sum_168 cr_high_no_any_168 cr_high_no_sum_168
#> 1                    NA                     NA                     NA                 NA                 NA
#> 2                    NA                      1                      3                  1                  3
#> 3                    NA                      1                      4                  1                  4
#> 4                    NA                      1                      5                  1                  5
#> 5                    NA                      1                      6                  1                  6
#> 6                    NA                      1                      9                  1                  9
#> 7                    NA                      1                     11                  1                 11
#> 8                    NA                      1                     12                  1                 12
#> 9                    NA                      1                     14                  1                 14
#> 10                   NA                      1                     15                  1                 15
#> 11                   NA                      1                     16                  1                 16
#> 12                   NA                      1                     19                  1                 19
#> 13                   NA                      1                     20                  1                 20
#> 14                   NA                      1                     22                  1                 22
#> 15                   NA                      1                     24                  1                 24
#> 16                   NA                      1                     25                  1                 25
#> 17                   NA                      1                     27                  1                 27
#> 18                   NA                      1                     28                  1                 28
#> 19                   NA                      1                     29                  1                 29
#> 20                   NA                      1                     30                  1                 30
#> 21                   NA                      1                     33                  1                 33
#> 22                   NA                      1                     33                  1                 33
#> 23                   NA                      1                     35                  1                 35
#> 24                   NA                      1                     38                  1                 38
#> 25                   NA                      1                     38                  1                 38
#> 26                    1                      1                     40                  1                 40
#> 27                    1                      1                     42                  1                 42
#> 28                    1                      1                     45                  1                 45
#> 29                    1                      1                     46                  1                 46
#> 30                    1                      1                     43                  1                 43
#> 31                    1                      1                     47                  1                 47
#> 32                    1                      1                     47                  1                 47
#> 33                    1                      1                     47                  1                 47
#> 34                    1                      1                     45                  1                 45
#> 35                    1                      1                     45                  1                 45
#> 36                    1                      1                     45                  1                 45
#> 37                    1                      1                     45                  1                 45
#> 38                    1                      1                     45                  1                 45
#>    cr_high_yes_any_168 cr_high_yes_sum_168 cr_length_06 cr_length_12 cr_max_06 cr_max_12 cr_mean_06 cr_mean_12
#> 1                   NA                  NA           NA           NA        NA        NA         NA         NA
#> 2                   NA                  NA            3           NA 1.2638285        NA  1.1086468         NA
#> 3                   NA                  NA            1            3 1.0766478 1.2638285  1.0766478  1.1086468
#> 4                   NA                  NA            1            1 1.1130560 1.0766478  1.1130560  1.0766478
#> 5                   NA                  NA            1            1 1.2141608 1.1130560  1.2141608  1.1130560
#> 6                   NA                  NA            3            1 1.0844537 1.2141608  1.0472493  1.2141608
#> 7                   NA                  NA            2            3 1.0819543 1.0844537  1.0331888  1.0472493
#> 8                   NA                  NA            1            2 1.0619762 1.0819543  1.0619762  1.0331888
#> 9                   NA                  NA            2            1 1.2018320 1.0619762  1.1535018  1.0619762
#> 10                  NA                  NA            1            2 1.0900804 1.2018320  1.0900804  1.1535018
#> 11                  NA                  NA            1            1 0.9217338 1.0900804  0.9217338  1.0900804
#> 12                  NA                  NA            3            1 1.2408438 0.9217338  1.1458185  0.9217338
#> 13                  NA                  NA            1            3 1.0420576 1.2408438  1.0420576  1.1458185
#> 14                  NA                  NA            2            1 1.2770125 1.0420576  1.2547565  1.0420576
#> 15                  NA                  NA            2            2 1.1115610 1.2770125  1.0617851  1.2547565
#> 16                  NA                  NA            1            2 1.1507102 1.1115610  1.1507102  1.0617851
#> 17                  NA                  NA            2            1 1.1536461 1.1507102  1.0902257  1.1507102
#> 18                  NA                  NA            1            2 1.1637019 1.1536461  1.1637019  1.0902257
#> 19                  NA                  NA            1            1 1.0572528 1.1637019  1.0572528  1.1637019
#> 20                  NA                  NA            1            1 1.1446662 1.0572528  1.1446662  1.0572528
#> 21                  NA                  NA            3            1 1.1479760 1.1446662  1.0724005  1.1446662
#> 22                  NA                  NA            3            3 1.1479760 1.1479760  1.0724005  1.0724005
#> 23                  NA                  NA            2            3 1.0601951 1.1479760  0.9976425  1.0724005
#> 24                  NA                  NA            3            2 1.1686259 1.0601951  1.0764339  0.9976425
#> 25                  NA                  NA            3            3 1.1686259 1.1686259  1.0764339  1.0764339
#> 26                   1                   1            3            3 1.3720007 1.1686259  1.2333154  1.0764339
#> 27                   1                   1            2            3 1.1569134 1.3720007  1.1455609  1.2333154
#> 28                   1                   1            3            2 1.1829338 1.1569134  1.1071208  1.1455609
#> 29                   1                   1            1            3 0.8634153 1.1829338  0.8634153  1.1071208
#> 30                   1                   1            1            1 0.8634153 0.8634153  0.8634153  0.8634153
#> 31                   1                   1            5            1 1.1821499 0.8634153  1.1347814  0.8634153
#> 32                   1                   1            1            5 0.9105404 1.1821499  0.9105404  1.1347814
#> 33                   1                   1            1            1 1.2302130 0.9105404  1.2302130  0.9105404
#> 34                   1                   1            1            1 1.2470802 1.2302130  1.2470802  1.2302130
#> 35                   1                   1            2            1 1.1274728 1.2470802  1.1118331  1.2470802
#> 36                   1                   1            1            2 0.9916900 1.1274728  0.9916900  1.1118331
#> 37                   1                   1            2            1 1.1677171 0.9916900  1.1199655  0.9916900
#> 38                   1                   1            1            2 0.9901681 1.1677171  0.9901681  1.1199655
#>    cr_median_06 cr_median_12 cr_min_06 cr_min_12
#> 1            NA           NA        NA        NA
#> 2     1.1826917           NA 0.8794202        NA
#> 3     1.0766478    1.1826917 1.0766478 0.8794202
#> 4     1.1130560    1.0766478 1.1130560 1.0766478
#> 5     1.2141608    1.1130560 1.2141608 1.1130560
#> 6     1.0334277    1.2141608 1.0238665 1.2141608
#> 7     1.0331888    1.0334277 0.9844234 1.0238665
#> 8     1.0619762    1.0331888 1.0619762 0.9844234
#> 9     1.1535018    1.0619762 1.1051716 1.0619762
#> 10    1.0900804    1.1535018 1.0900804 1.1051716
#> 11    0.9217338    1.0900804 0.9217338 1.0900804
#> 12    1.1187755    0.9217338 1.0778362 0.9217338
#> 13    1.0420576    1.1187755 1.0420576 1.0778362
#> 14    1.2547565    1.0420576 1.2325004 1.0420576
#> 15    1.0617851    1.2547565 1.0120093 1.2325004
#> 16    1.1507102    1.0617851 1.1507102 1.0120093
#> 17    1.0902257    1.1507102 1.0268054 1.1507102
#> 18    1.1637019    1.0902257 1.1637019 1.0268054
#> 19    1.0572528    1.1637019 1.0572528 1.1637019
#> 20    1.1446662    1.0572528 1.1446662 1.0572528
#> 21    1.0748734    1.1446662 0.9943519 1.1446662
#> 22    1.0748734    1.0748734 0.9943519 0.9943519
#> 23    0.9976425    1.0748734 0.9350898 0.9943519
#> 24    1.0904527    0.9976425 0.9702231 0.9350898
#> 25    1.0904527    1.0904527 0.9702231 0.9702231
#> 26    1.1996663    1.0904527 1.1282793 0.9702231
#> 27    1.1455609    1.1996663 1.1342083 1.1282793
#> 28    1.1597100    1.1455609 0.9787188 1.1342083
#> 29    0.8634153    1.1597100 0.8634153 0.9787188
#> 30    0.8634153    0.8634153 0.8634153 0.8634153
#> 31    1.1444065    0.8634153 1.0652481 0.8634153
#> 32    0.9105404    1.1444065 0.9105404 1.0652481
#> 33    1.2302130    0.9105404 1.2302130 0.9105404
#> 34    1.2470802    1.2302130 1.2470802 1.2302130
#> 35    1.1118331    1.2470802 1.0961934 1.2470802
#> 36    0.9916900    1.1118331 0.9916900 1.0961934
#> 37    1.1199655    0.9916900 1.0722140 0.9916900
#> 38    0.9901681    1.1199655 0.9901681 1.0722140
#>  [ reached 'max' / getOption("max.print") -- omitted 68 rows ]
```

## Testing wiz\_frame without writing to output files

If you want to simply test `wiz_frame`, you may prefer not to write your
output to file. You can accomplish this by setting `output_file` to
`FALSE`.

``` r
wf %>% 
  wiz_add_predictors(variable = 'cr',
                     lookback = lubridate::hours(12), 
                     window = lubridate::hours(6), 
                     stats = c(mean = mean,
                               min = min,
                               max = max,
                               median = median,
                               length = length),
                     output_file = FALSE)
#> Processing variable cr...
#> Anticipated number of rows in intermediate output: 212
#> Anticipated number of rows in final output: 106
#> [==>-------------------------------------------------------------------------] 9/212 ( 4%) Time remaining: 5s
#> [===>-----------------------------------------------------------------------] 10/212 ( 5%) Time remaining: 5s
#> [===>-----------------------------------------------------------------------] 11/212 ( 5%) Time remaining: 4s
#> [===>-----------------------------------------------------------------------] 12/212 ( 6%) Time remaining: 4s
#> [====>----------------------------------------------------------------------] 13/212 ( 6%) Time remaining: 4s
#> [====>----------------------------------------------------------------------] 14/212 ( 7%) Time remaining: 4s
#> [====>----------------------------------------------------------------------] 15/212 ( 7%) Time remaining: 4s
#> [=====>---------------------------------------------------------------------] 16/212 ( 8%) Time remaining: 4s
#> [=====>---------------------------------------------------------------------] 17/212 ( 8%) Time remaining: 4s
#> [=====>---------------------------------------------------------------------] 18/212 ( 8%) Time remaining: 4s
#> [======>--------------------------------------------------------------------] 19/212 ( 9%) Time remaining: 4s
#> [======>--------------------------------------------------------------------] 20/212 ( 9%) Time remaining: 4s
#> [======>--------------------------------------------------------------------] 21/212 ( 10%) Time remaining: 4s
#> [=======>-------------------------------------------------------------------] 22/212 ( 10%) Time remaining: 4s
#> [=======>-------------------------------------------------------------------] 23/212 ( 11%) Time remaining: 4s
#> [=======>-------------------------------------------------------------------] 24/212 ( 11%) Time remaining: 4s
#> [========>------------------------------------------------------------------] 25/212 ( 12%) Time remaining: 4s
#> [========>------------------------------------------------------------------] 26/212 ( 12%) Time remaining: 4s
#> [=========>-----------------------------------------------------------------] 27/212 ( 13%) Time remaining: 4s
#> [=========>-----------------------------------------------------------------] 28/212 ( 13%) Time remaining: 3s
#> [=========>-----------------------------------------------------------------] 29/212 ( 14%) Time remaining: 3s
#> [==========>----------------------------------------------------------------] 30/212 ( 14%) Time remaining: 3s
#> [==========>----------------------------------------------------------------] 31/212 ( 15%) Time remaining: 3s
#> [==========>----------------------------------------------------------------] 32/212 ( 15%) Time remaining: 3s
#> [===========>---------------------------------------------------------------] 33/212 ( 16%) Time remaining: 3s
#> [===========>---------------------------------------------------------------] 34/212 ( 16%) Time remaining: 3s
#> [===========>---------------------------------------------------------------] 35/212 ( 17%) Time remaining: 3s
#> [============>--------------------------------------------------------------] 36/212 ( 17%) Time remaining: 3s
#> [============>--------------------------------------------------------------] 37/212 ( 17%) Time remaining: 3s
#> [============>--------------------------------------------------------------] 38/212 ( 18%) Time remaining: 3s
#> [=============>-------------------------------------------------------------] 39/212 ( 18%) Time remaining: 3s
#> [=============>-------------------------------------------------------------] 40/212 ( 19%) Time remaining: 3s
#> [==============>------------------------------------------------------------] 41/212 ( 19%) Time remaining: 3s
#> [==============>------------------------------------------------------------] 42/212 ( 20%) Time remaining: 3s
#> [==============>------------------------------------------------------------] 43/212 ( 20%) Time remaining: 3s
#> [===============>-----------------------------------------------------------] 44/212 ( 21%) Time remaining: 3s
#> [===============>-----------------------------------------------------------] 45/212 ( 21%) Time remaining: 3s
#> [===============>-----------------------------------------------------------] 46/212 ( 22%) Time remaining: 3s
#> [================>----------------------------------------------------------] 47/212 ( 22%) Time remaining: 3s
#> [================>----------------------------------------------------------] 48/212 ( 23%) Time remaining: 3s
#> [================>----------------------------------------------------------] 49/212 ( 23%) Time remaining: 3s
#> [=================>---------------------------------------------------------] 50/212 ( 24%) Time remaining: 3s
#> [=================>---------------------------------------------------------] 51/212 ( 24%) Time remaining: 3s
#> [=================>---------------------------------------------------------] 52/212 ( 25%) Time remaining: 3s
#> [==================>--------------------------------------------------------] 53/212 ( 25%) Time remaining: 3s
#> [==================>--------------------------------------------------------] 54/212 ( 25%) Time remaining: 3s
#> [==================>--------------------------------------------------------] 55/212 ( 26%) Time remaining: 3s
#> [===================>-------------------------------------------------------] 56/212 ( 26%) Time remaining: 3s
#> [===================>-------------------------------------------------------] 57/212 ( 27%) Time remaining: 3s
#> [====================>------------------------------------------------------] 58/212 ( 27%) Time remaining: 3s
#> [====================>------------------------------------------------------] 59/212 ( 28%) Time remaining: 3s
#> [====================>------------------------------------------------------] 60/212 ( 28%) Time remaining: 3s
#> [=====================>-----------------------------------------------------] 61/212 ( 29%) Time remaining: 3s
#> [=====================>-----------------------------------------------------] 62/212 ( 29%) Time remaining: 3s
#> [=====================>-----------------------------------------------------] 63/212 ( 30%) Time remaining: 3s
#> [======================>----------------------------------------------------] 64/212 ( 30%) Time remaining: 3s
#> [======================>----------------------------------------------------] 65/212 ( 31%) Time remaining: 3s
#> [======================>----------------------------------------------------] 66/212 ( 31%) Time remaining: 3s
#> [=======================>---------------------------------------------------] 67/212 ( 32%) Time remaining: 3s
#> [=======================>---------------------------------------------------] 68/212 ( 32%) Time remaining: 3s
#> [=======================>---------------------------------------------------] 69/212 ( 33%) Time remaining: 3s
#> [========================>--------------------------------------------------] 70/212 ( 33%) Time remaining: 3s
#> [========================>--------------------------------------------------] 71/212 ( 33%) Time remaining: 3s
#> [========================>--------------------------------------------------] 72/212 ( 34%) Time remaining: 3s
#> [=========================>-------------------------------------------------] 73/212 ( 34%) Time remaining: 2s
#> [=========================>-------------------------------------------------] 74/212 ( 35%) Time remaining: 3s
#> [==========================>------------------------------------------------] 75/212 ( 35%) Time remaining: 2s
#> [==========================>------------------------------------------------] 76/212 ( 36%) Time remaining: 2s
#> [==========================>------------------------------------------------] 77/212 ( 36%) Time remaining: 2s
#> [===========================>-----------------------------------------------] 78/212 ( 37%) Time remaining: 2s
#> [===========================>-----------------------------------------------] 79/212 ( 37%) Time remaining: 2s
#> [===========================>-----------------------------------------------] 80/212 ( 38%) Time remaining: 2s
#> [============================>----------------------------------------------] 81/212 ( 38%) Time remaining: 2s
#> [============================>----------------------------------------------] 82/212 ( 39%) Time remaining: 2s
#> [============================>----------------------------------------------] 83/212 ( 39%) Time remaining: 2s
#> [=============================>---------------------------------------------] 84/212 ( 40%) Time remaining: 2s
#> [=============================>---------------------------------------------] 85/212 ( 40%) Time remaining: 2s
#> [=============================>---------------------------------------------] 86/212 ( 41%) Time remaining: 2s
#> [==============================>--------------------------------------------] 87/212 ( 41%) Time remaining: 2s
#> [==============================>--------------------------------------------] 88/212 ( 42%) Time remaining: 2s
#> [==============================>--------------------------------------------] 89/212 ( 42%) Time remaining: 2s
#> [===============================>-------------------------------------------] 90/212 ( 42%) Time remaining: 2s
#> [===============================>-------------------------------------------] 91/212 ( 43%) Time remaining: 2s
#> [================================>------------------------------------------] 92/212 ( 43%) Time remaining: 2s
#> [================================>------------------------------------------] 93/212 ( 44%) Time remaining: 2s
#> [================================>------------------------------------------] 94/212 ( 44%) Time remaining: 2s
#> [=================================>-----------------------------------------] 95/212 ( 45%) Time remaining: 2s
#> [=================================>-----------------------------------------] 96/212 ( 45%) Time remaining: 2s
#> [=================================>-----------------------------------------] 97/212 ( 46%) Time remaining: 2s
#> [==================================>----------------------------------------] 98/212 ( 46%) Time remaining: 2s
#> [==================================>----------------------------------------] 99/212 ( 47%) Time remaining: 2s
#> [==================================>---------------------------------------] 100/212 ( 47%) Time remaining: 2s
#> [==================================>---------------------------------------] 101/212 ( 48%) Time remaining: 2s
#> [===================================>--------------------------------------] 102/212 ( 48%) Time remaining: 2s
#> [===================================>--------------------------------------] 103/212 ( 49%) Time remaining: 2s
#> [===================================>--------------------------------------] 104/212 ( 49%) Time remaining: 2s
#> [====================================>-------------------------------------] 105/212 ( 50%) Time remaining: 2s
#> [====================================>-------------------------------------] 106/212 ( 50%) Time remaining: 2s
#> [====================================>-------------------------------------] 107/212 ( 50%) Time remaining: 2s
#> [=====================================>------------------------------------] 108/212 ( 51%) Time remaining: 2s
#> [=====================================>------------------------------------] 109/212 ( 51%) Time remaining: 2s
#> [=====================================>------------------------------------] 110/212 ( 52%) Time remaining: 2s
#> [======================================>-----------------------------------] 111/212 ( 52%) Time remaining: 2s
#> [======================================>-----------------------------------] 112/212 ( 53%) Time remaining: 2s
#> [======================================>-----------------------------------] 113/212 ( 53%) Time remaining: 2s
#> [=======================================>----------------------------------] 114/212 ( 54%) Time remaining: 2s
#> [=======================================>----------------------------------] 115/212 ( 54%) Time remaining: 2s
#> [=======================================>----------------------------------] 116/212 ( 55%) Time remaining: 2s
#> [========================================>---------------------------------] 117/212 ( 55%) Time remaining: 2s
#> [========================================>---------------------------------] 118/212 ( 56%) Time remaining: 2s
#> [=========================================>--------------------------------] 119/212 ( 56%) Time remaining: 2s
#> [=========================================>--------------------------------] 120/212 ( 57%) Time remaining: 2s
#> [=========================================>--------------------------------] 121/212 ( 57%) Time remaining: 2s
#> [==========================================>-------------------------------] 122/212 ( 58%) Time remaining: 2s
#> [==========================================>-------------------------------] 123/212 ( 58%) Time remaining: 2s
#> [==========================================>-------------------------------] 124/212 ( 58%) Time remaining: 2s
#> [===========================================>------------------------------] 125/212 ( 59%) Time remaining: 2s
#> [===========================================>------------------------------] 126/212 ( 59%) Time remaining: 2s
#> [===========================================>------------------------------] 127/212 ( 60%) Time remaining: 1s
#> [============================================>-----------------------------] 128/212 ( 60%) Time remaining: 1s
#> [============================================>-----------------------------] 129/212 ( 61%) Time remaining: 1s
#> [============================================>-----------------------------] 130/212 ( 61%) Time remaining: 1s
#> [=============================================>----------------------------] 131/212 ( 62%) Time remaining: 1s
#> [=============================================>----------------------------] 132/212 ( 62%) Time remaining: 1s
#> [=============================================>----------------------------] 133/212 ( 63%) Time remaining: 1s
#> [==============================================>---------------------------] 134/212 ( 63%) Time remaining: 1s
#> [==============================================>---------------------------] 135/212 ( 64%) Time remaining: 1s
#> [==============================================>---------------------------] 136/212 ( 64%) Time remaining: 1s
#> [===============================================>--------------------------] 137/212 ( 65%) Time remaining: 1s
#> [===============================================>--------------------------] 138/212 ( 65%) Time remaining: 1s
#> [================================================>-------------------------] 139/212 ( 66%) Time remaining: 1s
#> [================================================>-------------------------] 140/212 ( 66%) Time remaining: 1s
#> [================================================>-------------------------] 141/212 ( 67%) Time remaining: 1s
#> [=================================================>------------------------] 142/212 ( 67%) Time remaining: 1s
#> [=================================================>------------------------] 143/212 ( 67%) Time remaining: 1s
#> [=================================================>------------------------] 144/212 ( 68%) Time remaining: 1s
#> [==================================================>-----------------------] 145/212 ( 68%) Time remaining: 1s
#> [==================================================>-----------------------] 146/212 ( 69%) Time remaining: 1s
#> [==================================================>-----------------------] 147/212 ( 69%) Time remaining: 1s
#> [===================================================>----------------------] 148/212 ( 70%) Time remaining: 1s
#> [===================================================>----------------------] 149/212 ( 70%) Time remaining: 1s
#> [===================================================>----------------------] 150/212 ( 71%) Time remaining: 1s
#> [====================================================>---------------------] 151/212 ( 71%) Time remaining: 1s
#> [====================================================>---------------------] 152/212 ( 72%) Time remaining: 1s
#> [====================================================>---------------------] 153/212 ( 72%) Time remaining: 1s
#> [=====================================================>--------------------] 154/212 ( 73%) Time remaining: 1s
#> [=====================================================>--------------------] 155/212 ( 73%) Time remaining: 1s
#> [=====================================================>--------------------] 156/212 ( 74%) Time remaining: 1s
#> [======================================================>-------------------] 157/212 ( 74%) Time remaining: 1s
#> [======================================================>-------------------] 158/212 ( 75%) Time remaining: 1s
#> [=======================================================>------------------] 159/212 ( 75%) Time remaining: 1s
#> [=======================================================>------------------] 160/212 ( 75%) Time remaining: 1s
#> [=======================================================>------------------] 161/212 ( 76%) Time remaining: 1s
#> [========================================================>-----------------] 162/212 ( 76%) Time remaining: 1s
#> [========================================================>-----------------] 163/212 ( 77%) Time remaining: 1s
#> [========================================================>-----------------] 164/212 ( 77%) Time remaining: 1s
#> [=========================================================>----------------] 165/212 ( 78%) Time remaining: 1s
#> [=========================================================>----------------] 166/212 ( 78%) Time remaining: 1s
#> [=========================================================>----------------] 167/212 ( 79%) Time remaining: 1s
#> [==========================================================>---------------] 168/212 ( 79%) Time remaining: 1s
#> [==========================================================>---------------] 169/212 ( 80%) Time remaining: 1s
#> [==========================================================>---------------] 170/212 ( 80%) Time remaining: 1s
#> [===========================================================>--------------] 171/212 ( 81%) Time remaining: 1s
#> [===========================================================>--------------] 172/212 ( 81%) Time remaining: 1s
#> [===========================================================>--------------] 173/212 ( 82%) Time remaining: 1s
#> [============================================================>-------------] 174/212 ( 82%) Time remaining: 1s
#> [============================================================>-------------] 175/212 ( 83%) Time remaining: 1s
#> [============================================================>-------------] 176/212 ( 83%) Time remaining: 1s
#> [=============================================================>------------] 177/212 ( 83%) Time remaining: 1s
#> [=============================================================>------------] 178/212 ( 84%) Time remaining: 1s
#> [=============================================================>------------] 179/212 ( 84%) Time remaining: 1s
#> [==============================================================>-----------] 180/212 ( 85%) Time remaining: 1s
#> [==============================================================>-----------] 181/212 ( 85%) Time remaining: 1s
#> [===============================================================>----------] 182/212 ( 86%) Time remaining: 1s
#> [===============================================================>----------] 183/212 ( 86%) Time remaining: 1s
#> [===============================================================>----------] 184/212 ( 87%) Time remaining: 0s
#> [================================================================>---------] 185/212 ( 87%) Time remaining: 0s
#> [================================================================>---------] 186/212 ( 88%) Time remaining: 0s
#> [================================================================>---------] 187/212 ( 88%) Time remaining: 0s
#> [=================================================================>--------] 188/212 ( 89%) Time remaining: 0s
#> [=================================================================>--------] 189/212 ( 89%) Time remaining: 0s
#> [=================================================================>--------] 190/212 ( 90%) Time remaining: 0s
#> [==================================================================>-------] 191/212 ( 90%) Time remaining: 0s
#> [==================================================================>-------] 192/212 ( 91%) Time remaining: 0s
#> [==================================================================>-------] 193/212 ( 91%) Time remaining: 0s
#> [===================================================================>------] 194/212 ( 92%) Time remaining: 0s
#> [===================================================================>------] 195/212 ( 92%) Time remaining: 0s
#> [===================================================================>------] 196/212 ( 92%) Time remaining: 0s
#> [====================================================================>-----] 197/212 ( 93%) Time remaining: 0s
#> [====================================================================>-----] 198/212 ( 93%) Time remaining: 0s
#> [====================================================================>-----] 199/212 ( 94%) Time remaining: 0s
#> [=====================================================================>----] 200/212 ( 94%) Time remaining: 0s
#> [=====================================================================>----] 201/212 ( 95%) Time remaining: 0s
#> [======================================================================>---] 202/212 ( 95%) Time remaining: 0s
#> [======================================================================>---] 203/212 ( 96%) Time remaining: 0s
#> [======================================================================>---] 204/212 ( 96%) Time remaining: 0s
#> [=======================================================================>--] 205/212 ( 97%) Time remaining: 0s
#> [=======================================================================>--] 206/212 ( 97%) Time remaining: 0s
#> [=======================================================================>--] 207/212 ( 98%) Time remaining: 0s
#> [========================================================================>-] 208/212 ( 98%) Time remaining: 0s
#> [========================================================================>-] 209/212 ( 99%) Time remaining: 0s
#> [========================================================================>-] 210/212 ( 99%) Time remaining: 0s
#> [=========================================================================>] 211/212 (100%) Time remaining: 0s
#> [==========================================================================] 212/212 (100%) Time remaining: 0s
#> # A tibble: 106 x 12
#>       id  time cr_length_06 cr_length_12 cr_max_06 cr_max_12 cr_mean_06 cr_mean_12 cr_median_06 cr_median_12
#>    <int> <dbl>        <dbl>        <dbl>     <dbl>     <dbl>      <dbl>      <dbl>        <dbl>        <dbl>
#>  1     1     0           NA           NA     NA        NA         NA         NA           NA           NA   
#>  2     1     6            3           NA      1.26     NA          1.11      NA            1.18        NA   
#>  3     1    12            1            3      1.08      1.26       1.08       1.11         1.08         1.18
#>  4     1    18            1            1      1.11      1.08       1.11       1.08         1.11         1.08
#>  5     1    24            1            1      1.21      1.11       1.21       1.11         1.21         1.11
#>  6     1    30            3            1      1.08      1.21       1.05       1.21         1.03         1.21
#>  7     1    36            2            3      1.08      1.08       1.03       1.05         1.03         1.03
#>  8     1    42            1            2      1.06      1.08       1.06       1.03         1.06         1.03
#>  9     1    48            2            1      1.20      1.06       1.15       1.06         1.15         1.06
#> 10     1    54            1            2      1.09      1.20       1.09       1.15         1.09         1.15
#> # ... with 96 more rows, and 2 more variables: cr_min_06 <dbl>, cr_min_12 <dbl>
```

## You can supply a vector of variables

``` r
wf %>% 
  wiz_add_predictors(variable = c('cr', 'cr_high_no'),
                     lookback = lubridate::weeks(1), 
                     stats = c(any = any),
                     output_file = FALSE)
#> Processing variable cr, cr_high_no...
#> Anticipated number of rows in intermediate output: 106
#> Anticipated number of rows in final output: 106
#> [===>-----------------------------------------------------------------------] 10/212 ( 5%) Time remaining: 4s
#> [===>-----------------------------------------------------------------------] 11/212 ( 5%) Time remaining: 4s
#> [===>-----------------------------------------------------------------------] 12/212 ( 6%) Time remaining: 4s
#> [====>----------------------------------------------------------------------] 13/212 ( 6%) Time remaining: 4s
#> [====>----------------------------------------------------------------------] 14/212 ( 7%) Time remaining: 4s
#> [====>----------------------------------------------------------------------] 15/212 ( 7%) Time remaining: 4s
#> [=====>---------------------------------------------------------------------] 16/212 ( 8%) Time remaining: 4s
#> [=====>---------------------------------------------------------------------] 17/212 ( 8%) Time remaining: 4s
#> [=====>---------------------------------------------------------------------] 18/212 ( 8%) Time remaining: 4s
#> [======>--------------------------------------------------------------------] 19/212 ( 9%) Time remaining: 4s
#> [======>--------------------------------------------------------------------] 20/212 ( 9%) Time remaining: 3s
#> [======>--------------------------------------------------------------------] 21/212 ( 10%) Time remaining: 3s
#> [=======>-------------------------------------------------------------------] 22/212 ( 10%) Time remaining: 3s
#> [=======>-------------------------------------------------------------------] 23/212 ( 11%) Time remaining: 3s
#> [=======>-------------------------------------------------------------------] 24/212 ( 11%) Time remaining: 3s
#> [========>------------------------------------------------------------------] 25/212 ( 12%) Time remaining: 3s
#> [========>------------------------------------------------------------------] 26/212 ( 12%) Time remaining: 3s
#> [=========>-----------------------------------------------------------------] 27/212 ( 13%) Time remaining: 3s
#> [=========>-----------------------------------------------------------------] 28/212 ( 13%) Time remaining: 3s
#> [=========>-----------------------------------------------------------------] 29/212 ( 14%) Time remaining: 3s
#> [==========>----------------------------------------------------------------] 30/212 ( 14%) Time remaining: 3s
#> [==========>----------------------------------------------------------------] 31/212 ( 15%) Time remaining: 3s
#> [==========>----------------------------------------------------------------] 32/212 ( 15%) Time remaining: 3s
#> [===========>---------------------------------------------------------------] 33/212 ( 16%) Time remaining: 3s
#> [===========>---------------------------------------------------------------] 34/212 ( 16%) Time remaining: 3s
#> [===========>---------------------------------------------------------------] 35/212 ( 17%) Time remaining: 3s
#> [============>--------------------------------------------------------------] 36/212 ( 17%) Time remaining: 3s
#> [============>--------------------------------------------------------------] 37/212 ( 17%) Time remaining: 3s
#> [============>--------------------------------------------------------------] 38/212 ( 18%) Time remaining: 3s
#> [=============>-------------------------------------------------------------] 39/212 ( 18%) Time remaining: 3s
#> [=============>-------------------------------------------------------------] 40/212 ( 19%) Time remaining: 3s
#> [==============>------------------------------------------------------------] 41/212 ( 19%) Time remaining: 3s
#> [==============>------------------------------------------------------------] 42/212 ( 20%) Time remaining: 3s
#> [==============>------------------------------------------------------------] 43/212 ( 20%) Time remaining: 3s
#> [===============>-----------------------------------------------------------] 44/212 ( 21%) Time remaining: 3s
#> [===============>-----------------------------------------------------------] 45/212 ( 21%) Time remaining: 3s
#> [===============>-----------------------------------------------------------] 46/212 ( 22%) Time remaining: 3s
#> [================>----------------------------------------------------------] 47/212 ( 22%) Time remaining: 3s
#> [================>----------------------------------------------------------] 48/212 ( 23%) Time remaining: 3s
#> [================>----------------------------------------------------------] 49/212 ( 23%) Time remaining: 3s
#> [=================>---------------------------------------------------------] 50/212 ( 24%) Time remaining: 3s
#> [=================>---------------------------------------------------------] 51/212 ( 24%) Time remaining: 3s
#> [=================>---------------------------------------------------------] 52/212 ( 25%) Time remaining: 3s
#> [==================>--------------------------------------------------------] 53/212 ( 25%) Time remaining: 3s
#> [==================>--------------------------------------------------------] 54/212 ( 25%) Time remaining: 3s
#> [==================>--------------------------------------------------------] 55/212 ( 26%) Time remaining: 3s
#> [===================>-------------------------------------------------------] 56/212 ( 26%) Time remaining: 3s
#> [===================>-------------------------------------------------------] 57/212 ( 27%) Time remaining: 3s
#> [====================>------------------------------------------------------] 58/212 ( 27%) Time remaining: 3s
#> [====================>------------------------------------------------------] 59/212 ( 28%) Time remaining: 3s
#> [====================>------------------------------------------------------] 60/212 ( 28%) Time remaining: 3s
#> [=====================>-----------------------------------------------------] 61/212 ( 29%) Time remaining: 3s
#> [=====================>-----------------------------------------------------] 62/212 ( 29%) Time remaining: 3s
#> [=====================>-----------------------------------------------------] 63/212 ( 30%) Time remaining: 2s
#> [======================>----------------------------------------------------] 64/212 ( 30%) Time remaining: 2s
#> [======================>----------------------------------------------------] 65/212 ( 31%) Time remaining: 2s
#> [======================>----------------------------------------------------] 66/212 ( 31%) Time remaining: 2s
#> [=======================>---------------------------------------------------] 67/212 ( 32%) Time remaining: 2s
#> [=======================>---------------------------------------------------] 68/212 ( 32%) Time remaining: 2s
#> [=======================>---------------------------------------------------] 69/212 ( 33%) Time remaining: 2s
#> [========================>--------------------------------------------------] 70/212 ( 33%) Time remaining: 2s
#> [========================>--------------------------------------------------] 71/212 ( 33%) Time remaining: 2s
#> [========================>--------------------------------------------------] 72/212 ( 34%) Time remaining: 2s
#> [=========================>-------------------------------------------------] 73/212 ( 34%) Time remaining: 2s
#> [=========================>-------------------------------------------------] 74/212 ( 35%) Time remaining: 2s
#> [==========================>------------------------------------------------] 75/212 ( 35%) Time remaining: 2s
#> [==========================>------------------------------------------------] 76/212 ( 36%) Time remaining: 2s
#> [==========================>------------------------------------------------] 77/212 ( 36%) Time remaining: 2s
#> [===========================>-----------------------------------------------] 78/212 ( 37%) Time remaining: 2s
#> [===========================>-----------------------------------------------] 79/212 ( 37%) Time remaining: 2s
#> [===========================>-----------------------------------------------] 80/212 ( 38%) Time remaining: 2s
#> [============================>----------------------------------------------] 81/212 ( 38%) Time remaining: 2s
#> [============================>----------------------------------------------] 82/212 ( 39%) Time remaining: 2s
#> [============================>----------------------------------------------] 83/212 ( 39%) Time remaining: 2s
#> [=============================>---------------------------------------------] 84/212 ( 40%) Time remaining: 2s
#> [=============================>---------------------------------------------] 85/212 ( 40%) Time remaining: 2s
#> [=============================>---------------------------------------------] 86/212 ( 41%) Time remaining: 2s
#> [==============================>--------------------------------------------] 87/212 ( 41%) Time remaining: 2s
#> [==============================>--------------------------------------------] 88/212 ( 42%) Time remaining: 2s
#> [==============================>--------------------------------------------] 89/212 ( 42%) Time remaining: 2s
#> [===============================>-------------------------------------------] 90/212 ( 42%) Time remaining: 2s
#> [===============================>-------------------------------------------] 91/212 ( 43%) Time remaining: 2s
#> [================================>------------------------------------------] 92/212 ( 43%) Time remaining: 2s
#> [================================>------------------------------------------] 93/212 ( 44%) Time remaining: 2s
#> [================================>------------------------------------------] 94/212 ( 44%) Time remaining: 2s
#> [=================================>-----------------------------------------] 95/212 ( 45%) Time remaining: 2s
#> [=================================>-----------------------------------------] 96/212 ( 45%) Time remaining: 2s
#> [=================================>-----------------------------------------] 97/212 ( 46%) Time remaining: 2s
#> [==================================>----------------------------------------] 98/212 ( 46%) Time remaining: 2s
#> [==================================>----------------------------------------] 99/212 ( 47%) Time remaining: 2s
#> [==================================>---------------------------------------] 100/212 ( 47%) Time remaining: 2s
#> [==================================>---------------------------------------] 101/212 ( 48%) Time remaining: 2s
#> [===================================>--------------------------------------] 102/212 ( 48%) Time remaining: 2s
#> [===================================>--------------------------------------] 103/212 ( 49%) Time remaining: 2s
#> [===================================>--------------------------------------] 104/212 ( 49%) Time remaining: 2s
#> [====================================>-------------------------------------] 105/212 ( 50%) Time remaining: 2s
#> [====================================>-------------------------------------] 106/212 ( 50%) Time remaining: 2s
#> # A tibble: 106 x 4
#>       id  time cr_any_168 cr_high_no_any_168
#>    <int> <dbl>      <dbl>              <dbl>
#>  1     1     0         NA                 NA
#>  2     1     6          1                  1
#>  3     1    12          1                  1
#>  4     1    18          1                  1
#>  5     1    24          1                  1
#>  6     1    30          1                  1
#>  7     1    36          1                  1
#>  8     1    42          1                  1
#>  9     1    48          1                  1
#> 10     1    54          1                  1
#> # ... with 96 more rows
```

## Let’s benchmark the new add\_predictors() function versus the old one

``` r
new = wf %>% 
  wiz_add_predictors(variable = 'cr',
                     lookback = lubridate::hours(12), 
                     window = lubridate::hours(6), 
                     stats = c(mean = mean,
                               min = min,
                               max = max,
                               median = median,
                               length = length),
                     output_file = FALSE)
#> Processing variable cr...
#> Anticipated number of rows in intermediate output: 212
#> Anticipated number of rows in final output: 106
#> [===>-----------------------------------------------------------------------] 10/212 ( 5%) Time remaining: 4s
#> [===>-----------------------------------------------------------------------] 11/212 ( 5%) Time remaining: 4s
#> [===>-----------------------------------------------------------------------] 12/212 ( 6%) Time remaining: 4s
#> [====>----------------------------------------------------------------------] 13/212 ( 6%) Time remaining: 4s
#> [====>----------------------------------------------------------------------] 14/212 ( 7%) Time remaining: 4s
#> [====>----------------------------------------------------------------------] 15/212 ( 7%) Time remaining: 4s
#> [=====>---------------------------------------------------------------------] 16/212 ( 8%) Time remaining: 4s
#> [=====>---------------------------------------------------------------------] 17/212 ( 8%) Time remaining: 4s
#> [=====>---------------------------------------------------------------------] 18/212 ( 8%) Time remaining: 4s
#> [======>--------------------------------------------------------------------] 19/212 ( 9%) Time remaining: 4s
#> [======>--------------------------------------------------------------------] 20/212 ( 9%) Time remaining: 4s
#> [======>--------------------------------------------------------------------] 21/212 ( 10%) Time remaining: 4s
#> [=======>-------------------------------------------------------------------] 22/212 ( 10%) Time remaining: 3s
#> [=======>-------------------------------------------------------------------] 23/212 ( 11%) Time remaining: 3s
#> [=======>-------------------------------------------------------------------] 24/212 ( 11%) Time remaining: 3s
#> [========>------------------------------------------------------------------] 25/212 ( 12%) Time remaining: 3s
#> [========>------------------------------------------------------------------] 26/212 ( 12%) Time remaining: 3s
#> [=========>-----------------------------------------------------------------] 27/212 ( 13%) Time remaining: 3s
#> [=========>-----------------------------------------------------------------] 28/212 ( 13%) Time remaining: 3s
#> [=========>-----------------------------------------------------------------] 29/212 ( 14%) Time remaining: 3s
#> [==========>----------------------------------------------------------------] 30/212 ( 14%) Time remaining: 3s
#> [==========>----------------------------------------------------------------] 31/212 ( 15%) Time remaining: 3s
#> [==========>----------------------------------------------------------------] 32/212 ( 15%) Time remaining: 3s
#> [===========>---------------------------------------------------------------] 33/212 ( 16%) Time remaining: 3s
#> [===========>---------------------------------------------------------------] 34/212 ( 16%) Time remaining: 3s
#> [===========>---------------------------------------------------------------] 35/212 ( 17%) Time remaining: 3s
#> [============>--------------------------------------------------------------] 36/212 ( 17%) Time remaining: 3s
#> [============>--------------------------------------------------------------] 37/212 ( 17%) Time remaining: 3s
#> [============>--------------------------------------------------------------] 38/212 ( 18%) Time remaining: 3s
#> [=============>-------------------------------------------------------------] 39/212 ( 18%) Time remaining: 3s
#> [=============>-------------------------------------------------------------] 40/212 ( 19%) Time remaining: 3s
#> [==============>------------------------------------------------------------] 41/212 ( 19%) Time remaining: 3s
#> [==============>------------------------------------------------------------] 42/212 ( 20%) Time remaining: 3s
#> [==============>------------------------------------------------------------] 43/212 ( 20%) Time remaining: 3s
#> [===============>-----------------------------------------------------------] 44/212 ( 21%) Time remaining: 3s
#> [===============>-----------------------------------------------------------] 45/212 ( 21%) Time remaining: 3s
#> [===============>-----------------------------------------------------------] 46/212 ( 22%) Time remaining: 3s
#> [================>----------------------------------------------------------] 47/212 ( 22%) Time remaining: 3s
#> [================>----------------------------------------------------------] 48/212 ( 23%) Time remaining: 3s
#> [================>----------------------------------------------------------] 49/212 ( 23%) Time remaining: 3s
#> [=================>---------------------------------------------------------] 50/212 ( 24%) Time remaining: 3s
#> [=================>---------------------------------------------------------] 51/212 ( 24%) Time remaining: 3s
#> [=================>---------------------------------------------------------] 52/212 ( 25%) Time remaining: 3s
#> [==================>--------------------------------------------------------] 53/212 ( 25%) Time remaining: 3s
#> [==================>--------------------------------------------------------] 54/212 ( 25%) Time remaining: 3s
#> [==================>--------------------------------------------------------] 55/212 ( 26%) Time remaining: 3s
#> [===================>-------------------------------------------------------] 56/212 ( 26%) Time remaining: 3s
#> [===================>-------------------------------------------------------] 57/212 ( 27%) Time remaining: 3s
#> [====================>------------------------------------------------------] 58/212 ( 27%) Time remaining: 3s
#> [====================>------------------------------------------------------] 59/212 ( 28%) Time remaining: 3s
#> [====================>------------------------------------------------------] 60/212 ( 28%) Time remaining: 3s
#> [=====================>-----------------------------------------------------] 61/212 ( 29%) Time remaining: 3s
#> [=====================>-----------------------------------------------------] 62/212 ( 29%) Time remaining: 3s
#> [=====================>-----------------------------------------------------] 63/212 ( 30%) Time remaining: 3s
#> [======================>----------------------------------------------------] 64/212 ( 30%) Time remaining: 3s
#> [======================>----------------------------------------------------] 65/212 ( 31%) Time remaining: 3s
#> [======================>----------------------------------------------------] 66/212 ( 31%) Time remaining: 3s
#> [=======================>---------------------------------------------------] 67/212 ( 32%) Time remaining: 3s
#> [=======================>---------------------------------------------------] 68/212 ( 32%) Time remaining: 3s
#> [=======================>---------------------------------------------------] 69/212 ( 33%) Time remaining: 3s
#> [========================>--------------------------------------------------] 70/212 ( 33%) Time remaining: 2s
#> [========================>--------------------------------------------------] 71/212 ( 33%) Time remaining: 2s
#> [========================>--------------------------------------------------] 72/212 ( 34%) Time remaining: 2s
#> [=========================>-------------------------------------------------] 73/212 ( 34%) Time remaining: 2s
#> [=========================>-------------------------------------------------] 74/212 ( 35%) Time remaining: 2s
#> [==========================>------------------------------------------------] 75/212 ( 35%) Time remaining: 2s
#> [==========================>------------------------------------------------] 76/212 ( 36%) Time remaining: 2s
#> [==========================>------------------------------------------------] 77/212 ( 36%) Time remaining: 2s
#> [===========================>-----------------------------------------------] 78/212 ( 37%) Time remaining: 2s
#> [===========================>-----------------------------------------------] 79/212 ( 37%) Time remaining: 2s
#> [===========================>-----------------------------------------------] 80/212 ( 38%) Time remaining: 2s
#> [============================>----------------------------------------------] 81/212 ( 38%) Time remaining: 2s
#> [============================>----------------------------------------------] 82/212 ( 39%) Time remaining: 2s
#> [============================>----------------------------------------------] 83/212 ( 39%) Time remaining: 2s
#> [=============================>---------------------------------------------] 84/212 ( 40%) Time remaining: 2s
#> [=============================>---------------------------------------------] 85/212 ( 40%) Time remaining: 2s
#> [=============================>---------------------------------------------] 86/212 ( 41%) Time remaining: 2s
#> [==============================>--------------------------------------------] 87/212 ( 41%) Time remaining: 2s
#> [==============================>--------------------------------------------] 88/212 ( 42%) Time remaining: 2s
#> [==============================>--------------------------------------------] 89/212 ( 42%) Time remaining: 2s
#> [===============================>-------------------------------------------] 90/212 ( 42%) Time remaining: 2s
#> [===============================>-------------------------------------------] 91/212 ( 43%) Time remaining: 2s
#> [================================>------------------------------------------] 92/212 ( 43%) Time remaining: 2s
#> [================================>------------------------------------------] 93/212 ( 44%) Time remaining: 2s
#> [================================>------------------------------------------] 94/212 ( 44%) Time remaining: 2s
#> [=================================>-----------------------------------------] 95/212 ( 45%) Time remaining: 2s
#> [=================================>-----------------------------------------] 96/212 ( 45%) Time remaining: 2s
#> [=================================>-----------------------------------------] 97/212 ( 46%) Time remaining: 2s
#> [==================================>----------------------------------------] 98/212 ( 46%) Time remaining: 2s
#> [==================================>----------------------------------------] 99/212 ( 47%) Time remaining: 2s
#> [==================================>---------------------------------------] 100/212 ( 47%) Time remaining: 2s
#> [==================================>---------------------------------------] 101/212 ( 48%) Time remaining: 2s
#> [===================================>--------------------------------------] 102/212 ( 48%) Time remaining: 2s
#> [===================================>--------------------------------------] 103/212 ( 49%) Time remaining: 2s
#> [===================================>--------------------------------------] 104/212 ( 49%) Time remaining: 2s
#> [====================================>-------------------------------------] 105/212 ( 50%) Time remaining: 2s
#> [====================================>-------------------------------------] 106/212 ( 50%) Time remaining: 2s
#> [====================================>-------------------------------------] 107/212 ( 50%) Time remaining: 2s
#> [=====================================>------------------------------------] 108/212 ( 51%) Time remaining: 2s
#> [=====================================>------------------------------------] 109/212 ( 51%) Time remaining: 2s
#> [=====================================>------------------------------------] 110/212 ( 52%) Time remaining: 2s
#> [======================================>-----------------------------------] 111/212 ( 52%) Time remaining: 2s
#> [======================================>-----------------------------------] 112/212 ( 53%) Time remaining: 2s
#> [======================================>-----------------------------------] 113/212 ( 53%) Time remaining: 2s
#> [=======================================>----------------------------------] 114/212 ( 54%) Time remaining: 2s
#> [=======================================>----------------------------------] 115/212 ( 54%) Time remaining: 2s
#> [=======================================>----------------------------------] 116/212 ( 55%) Time remaining: 2s
#> [========================================>---------------------------------] 117/212 ( 55%) Time remaining: 2s
#> [========================================>---------------------------------] 118/212 ( 56%) Time remaining: 2s
#> [=========================================>--------------------------------] 119/212 ( 56%) Time remaining: 2s
#> [=========================================>--------------------------------] 120/212 ( 57%) Time remaining: 2s
#> [=========================================>--------------------------------] 121/212 ( 57%) Time remaining: 2s
#> [==========================================>-------------------------------] 122/212 ( 58%) Time remaining: 2s
#> [==========================================>-------------------------------] 123/212 ( 58%) Time remaining: 2s
#> [==========================================>-------------------------------] 124/212 ( 58%) Time remaining: 2s
#> [===========================================>------------------------------] 125/212 ( 59%) Time remaining: 1s
#> [===========================================>------------------------------] 126/212 ( 59%) Time remaining: 1s
#> [===========================================>------------------------------] 127/212 ( 60%) Time remaining: 1s
#> [============================================>-----------------------------] 128/212 ( 60%) Time remaining: 1s
#> [============================================>-----------------------------] 129/212 ( 61%) Time remaining: 1s
#> [============================================>-----------------------------] 130/212 ( 61%) Time remaining: 1s
#> [=============================================>----------------------------] 131/212 ( 62%) Time remaining: 1s
#> [=============================================>----------------------------] 132/212 ( 62%) Time remaining: 1s
#> [=============================================>----------------------------] 133/212 ( 63%) Time remaining: 1s
#> [==============================================>---------------------------] 134/212 ( 63%) Time remaining: 1s
#> [==============================================>---------------------------] 135/212 ( 64%) Time remaining: 1s
#> [==============================================>---------------------------] 136/212 ( 64%) Time remaining: 1s
#> [===============================================>--------------------------] 137/212 ( 65%) Time remaining: 1s
#> [===============================================>--------------------------] 138/212 ( 65%) Time remaining: 1s
#> [================================================>-------------------------] 139/212 ( 66%) Time remaining: 1s
#> [================================================>-------------------------] 140/212 ( 66%) Time remaining: 1s
#> [================================================>-------------------------] 141/212 ( 67%) Time remaining: 1s
#> [=================================================>------------------------] 142/212 ( 67%) Time remaining: 1s
#> [=================================================>------------------------] 143/212 ( 67%) Time remaining: 1s
#> [=================================================>------------------------] 144/212 ( 68%) Time remaining: 1s
#> [==================================================>-----------------------] 145/212 ( 68%) Time remaining: 1s
#> [==================================================>-----------------------] 146/212 ( 69%) Time remaining: 1s
#> [==================================================>-----------------------] 147/212 ( 69%) Time remaining: 1s
#> [===================================================>----------------------] 148/212 ( 70%) Time remaining: 1s
#> [===================================================>----------------------] 149/212 ( 70%) Time remaining: 1s
#> [===================================================>----------------------] 150/212 ( 71%) Time remaining: 1s
#> [====================================================>---------------------] 151/212 ( 71%) Time remaining: 1s
#> [====================================================>---------------------] 152/212 ( 72%) Time remaining: 1s
#> [====================================================>---------------------] 153/212 ( 72%) Time remaining: 1s
#> [=====================================================>--------------------] 154/212 ( 73%) Time remaining: 1s
#> [=====================================================>--------------------] 155/212 ( 73%) Time remaining: 1s
#> [=====================================================>--------------------] 156/212 ( 74%) Time remaining: 1s
#> [======================================================>-------------------] 157/212 ( 74%) Time remaining: 1s
#> [======================================================>-------------------] 158/212 ( 75%) Time remaining: 1s
#> [=======================================================>------------------] 159/212 ( 75%) Time remaining: 1s
#> [=======================================================>------------------] 160/212 ( 75%) Time remaining: 1s
#> [=======================================================>------------------] 161/212 ( 76%) Time remaining: 1s
#> [========================================================>-----------------] 162/212 ( 76%) Time remaining: 1s
#> [========================================================>-----------------] 163/212 ( 77%) Time remaining: 1s
#> [========================================================>-----------------] 164/212 ( 77%) Time remaining: 1s
#> [=========================================================>----------------] 165/212 ( 78%) Time remaining: 1s
#> [=========================================================>----------------] 166/212 ( 78%) Time remaining: 1s
#> [=========================================================>----------------] 167/212 ( 79%) Time remaining: 1s
#> [==========================================================>---------------] 168/212 ( 79%) Time remaining: 1s
#> [==========================================================>---------------] 169/212 ( 80%) Time remaining: 1s
#> [==========================================================>---------------] 170/212 ( 80%) Time remaining: 1s
#> [===========================================================>--------------] 171/212 ( 81%) Time remaining: 1s
#> [===========================================================>--------------] 172/212 ( 81%) Time remaining: 1s
#> [===========================================================>--------------] 173/212 ( 82%) Time remaining: 1s
#> [============================================================>-------------] 174/212 ( 82%) Time remaining: 1s
#> [============================================================>-------------] 175/212 ( 83%) Time remaining: 1s
#> [============================================================>-------------] 176/212 ( 83%) Time remaining: 1s
#> [=============================================================>------------] 177/212 ( 83%) Time remaining: 1s
#> [=============================================================>------------] 178/212 ( 84%) Time remaining: 1s
#> [=============================================================>------------] 179/212 ( 84%) Time remaining: 1s
#> [==============================================================>-----------] 180/212 ( 85%) Time remaining: 1s
#> [==============================================================>-----------] 181/212 ( 85%) Time remaining: 1s
#> [===============================================================>----------] 182/212 ( 86%) Time remaining: 1s
#> [===============================================================>----------] 183/212 ( 86%) Time remaining: 0s
#> [===============================================================>----------] 184/212 ( 87%) Time remaining: 0s
#> [================================================================>---------] 185/212 ( 87%) Time remaining: 0s
#> [================================================================>---------] 186/212 ( 88%) Time remaining: 0s
#> [================================================================>---------] 187/212 ( 88%) Time remaining: 0s
#> [=================================================================>--------] 188/212 ( 89%) Time remaining: 0s
#> [=================================================================>--------] 189/212 ( 89%) Time remaining: 0s
#> [=================================================================>--------] 190/212 ( 90%) Time remaining: 0s
#> [==================================================================>-------] 191/212 ( 90%) Time remaining: 0s
#> [==================================================================>-------] 192/212 ( 91%) Time remaining: 0s
#> [==================================================================>-------] 193/212 ( 91%) Time remaining: 0s
#> [===================================================================>------] 194/212 ( 92%) Time remaining: 0s
#> [===================================================================>------] 195/212 ( 92%) Time remaining: 0s
#> [===================================================================>------] 196/212 ( 92%) Time remaining: 0s
#> [====================================================================>-----] 197/212 ( 93%) Time remaining: 0s
#> [====================================================================>-----] 198/212 ( 93%) Time remaining: 0s
#> [====================================================================>-----] 199/212 ( 94%) Time remaining: 0s
#> [=====================================================================>----] 200/212 ( 94%) Time remaining: 0s
#> [=====================================================================>----] 201/212 ( 95%) Time remaining: 0s
#> [======================================================================>---] 202/212 ( 95%) Time remaining: 0s
#> [======================================================================>---] 203/212 ( 96%) Time remaining: 0s
#> [======================================================================>---] 204/212 ( 96%) Time remaining: 0s
#> [=======================================================================>--] 205/212 ( 97%) Time remaining: 0s
#> [=======================================================================>--] 206/212 ( 97%) Time remaining: 0s
#> [=======================================================================>--] 207/212 ( 98%) Time remaining: 0s
#> [========================================================================>-] 208/212 ( 98%) Time remaining: 0s
#> [========================================================================>-] 209/212 ( 99%) Time remaining: 0s
#> [========================================================================>-] 210/212 ( 99%) Time remaining: 0s
#> [=========================================================================>] 211/212 (100%) Time remaining: 0s
#> [==========================================================================] 212/212 (100%) Time remaining: 0s

old = wf %>% 
  wiz_add_predictors_old(variable = 'cr',
                     lookback = lubridate::hours(12), 
                     window = lubridate::hours(6), 
                     stats = c(mean = mean,
                               min = min,
                               max = max,
                               median = median,
                               length = length),
                     output_file = FALSE)
#> Processing variable cr...
#> Anticipated number of rows in intermediate output: 212
#> Anticipated number of rows in final output: 106
#> Number of ids to process: 2
#> [==>-------------------------------------------------------------------------] 7/212 (  3%) Time remaining:  6s[==>-------------------------------------------------------------------------] 8/212 (  4%) Time remaining:  6s[==>-------------------------------------------------------------------------] 9/212 (  4%) Time remaining:  6s[===>-----------------------------------------------------------------------] 10/212 (  5%) Time remaining:  6s[===>-----------------------------------------------------------------------] 11/212 (  5%) Time remaining:  6s[===>-----------------------------------------------------------------------] 12/212 (  6%) Time remaining:  6s[====>----------------------------------------------------------------------] 13/212 (  6%) Time remaining:  6s[====>----------------------------------------------------------------------] 14/212 (  7%) Time remaining:  6s[====>----------------------------------------------------------------------] 15/212 (  7%) Time remaining:  6s[=====>---------------------------------------------------------------------] 16/212 (  8%) Time remaining:  6s[=====>---------------------------------------------------------------------] 17/212 (  8%) Time remaining:  6s[=====>---------------------------------------------------------------------] 18/212 (  8%) Time remaining:  6s[======>--------------------------------------------------------------------] 19/212 (  9%) Time remaining:  6s[======>--------------------------------------------------------------------] 20/212 (  9%) Time remaining:  6s[======>--------------------------------------------------------------------] 21/212 ( 10%) Time remaining:  6s[=======>-------------------------------------------------------------------] 22/212 ( 10%) Time remaining:  6s[=======>-------------------------------------------------------------------] 23/212 ( 11%) Time remaining:  6s[=======>-------------------------------------------------------------------] 24/212 ( 11%) Time remaining:  6s[========>------------------------------------------------------------------] 25/212 ( 12%) Time remaining:  6s[========>------------------------------------------------------------------] 26/212 ( 12%) Time remaining:  6s[=========>-----------------------------------------------------------------] 27/212 ( 13%) Time remaining:  6s[=========>-----------------------------------------------------------------] 28/212 ( 13%) Time remaining:  6s[=========>-----------------------------------------------------------------] 29/212 ( 14%) Time remaining:  6s[==========>----------------------------------------------------------------] 30/212 ( 14%) Time remaining:  6s[==========>----------------------------------------------------------------] 31/212 ( 15%) Time remaining:  6s[==========>----------------------------------------------------------------] 32/212 ( 15%) Time remaining:  6s[===========>---------------------------------------------------------------] 33/212 ( 16%) Time remaining:  6s[===========>---------------------------------------------------------------] 34/212 ( 16%) Time remaining:  6s[===========>---------------------------------------------------------------] 35/212 ( 17%) Time remaining:  6s[============>--------------------------------------------------------------] 36/212 ( 17%) Time remaining:  6s[============>--------------------------------------------------------------] 37/212 ( 17%) Time remaining:  5s[============>--------------------------------------------------------------] 38/212 ( 18%) Time remaining:  5s[=============>-------------------------------------------------------------] 39/212 ( 18%) Time remaining:  5s[=============>-------------------------------------------------------------] 40/212 ( 19%) Time remaining:  5s[==============>------------------------------------------------------------] 41/212 ( 19%) Time remaining:  5s[==============>------------------------------------------------------------] 42/212 ( 20%) Time remaining:  5s[==============>------------------------------------------------------------] 43/212 ( 20%) Time remaining:  5s[===============>-----------------------------------------------------------] 44/212 ( 21%) Time remaining:  5s[===============>-----------------------------------------------------------] 45/212 ( 21%) Time remaining:  5s[===============>-----------------------------------------------------------] 46/212 ( 22%) Time remaining:  5s[================>----------------------------------------------------------] 47/212 ( 22%) Time remaining:  5s[================>----------------------------------------------------------] 48/212 ( 23%) Time remaining:  5s[================>----------------------------------------------------------] 49/212 ( 23%) Time remaining:  5s[=================>---------------------------------------------------------] 50/212 ( 24%) Time remaining:  5s[=================>---------------------------------------------------------] 51/212 ( 24%) Time remaining:  5s[=================>---------------------------------------------------------] 52/212 ( 25%) Time remaining:  5s[==================>--------------------------------------------------------] 53/212 ( 25%) Time remaining:  5s[==================>--------------------------------------------------------] 54/212 ( 25%) Time remaining:  5s[==================>--------------------------------------------------------] 55/212 ( 26%) Time remaining:  5s[===================>-------------------------------------------------------] 56/212 ( 26%) Time remaining:  5s[===================>-------------------------------------------------------] 57/212 ( 27%) Time remaining:  5s[====================>------------------------------------------------------] 58/212 ( 27%) Time remaining:  5s[====================>------------------------------------------------------] 59/212 ( 28%) Time remaining:  5s[====================>------------------------------------------------------] 60/212 ( 28%) Time remaining:  5s[=====================>-----------------------------------------------------] 61/212 ( 29%) Time remaining:  5s[=====================>-----------------------------------------------------] 62/212 ( 29%) Time remaining:  5s[=====================>-----------------------------------------------------] 63/212 ( 30%) Time remaining:  5s[======================>----------------------------------------------------] 64/212 ( 30%) Time remaining:  5s[======================>----------------------------------------------------] 65/212 ( 31%) Time remaining:  5s[======================>----------------------------------------------------] 66/212 ( 31%) Time remaining:  5s[=======================>---------------------------------------------------] 67/212 ( 32%) Time remaining:  5s[=======================>---------------------------------------------------] 68/212 ( 32%) Time remaining:  5s[=======================>---------------------------------------------------] 69/212 ( 33%) Time remaining:  4s[========================>--------------------------------------------------] 70/212 ( 33%) Time remaining:  4s[========================>--------------------------------------------------] 71/212 ( 33%) Time remaining:  4s[========================>--------------------------------------------------] 72/212 ( 34%) Time remaining:  4s[=========================>-------------------------------------------------] 73/212 ( 34%) Time remaining:  4s[=========================>-------------------------------------------------] 74/212 ( 35%) Time remaining:  4s[==========================>------------------------------------------------] 75/212 ( 35%) Time remaining:  4s[==========================>------------------------------------------------] 76/212 ( 36%) Time remaining:  4s[==========================>------------------------------------------------] 77/212 ( 36%) Time remaining:  4s[===========================>-----------------------------------------------] 78/212 ( 37%) Time remaining:  4s[===========================>-----------------------------------------------] 79/212 ( 37%) Time remaining:  4s[===========================>-----------------------------------------------] 80/212 ( 38%) Time remaining:  4s[============================>----------------------------------------------] 81/212 ( 38%) Time remaining:  4s[============================>----------------------------------------------] 82/212 ( 39%) Time remaining:  4s[============================>----------------------------------------------] 83/212 ( 39%) Time remaining:  4s[=============================>---------------------------------------------] 84/212 ( 40%) Time remaining:  4s[=============================>---------------------------------------------] 85/212 ( 40%) Time remaining:  4s[=============================>---------------------------------------------] 86/212 ( 41%) Time remaining:  4s[==============================>--------------------------------------------] 87/212 ( 41%) Time remaining:  4s[==============================>--------------------------------------------] 88/212 ( 42%) Time remaining:  4s[==============================>--------------------------------------------] 89/212 ( 42%) Time remaining:  4s[===============================>-------------------------------------------] 90/212 ( 42%) Time remaining:  4s[===============================>-------------------------------------------] 91/212 ( 43%) Time remaining:  4s[================================>------------------------------------------] 92/212 ( 43%) Time remaining:  4s[================================>------------------------------------------] 93/212 ( 44%) Time remaining:  4s[================================>------------------------------------------] 94/212 ( 44%) Time remaining:  4s[=================================>-----------------------------------------] 95/212 ( 45%) Time remaining:  4s[=================================>-----------------------------------------] 96/212 ( 45%) Time remaining:  4s[=================================>-----------------------------------------] 97/212 ( 46%) Time remaining:  4s[==================================>----------------------------------------] 98/212 ( 46%) Time remaining:  4s[==================================>----------------------------------------] 99/212 ( 47%) Time remaining:  4s[==================================>---------------------------------------] 100/212 ( 47%) Time remaining:  3s[==================================>---------------------------------------] 101/212 ( 48%) Time remaining:  3s[===================================>--------------------------------------] 102/212 ( 48%) Time remaining:  3s[===================================>--------------------------------------] 103/212 ( 49%) Time remaining:  3s[===================================>--------------------------------------] 104/212 ( 49%) Time remaining:  3s[====================================>-------------------------------------] 105/212 ( 50%) Time remaining:  3s[====================================>-------------------------------------] 106/212 ( 50%) Time remaining:  3s[====================================>-------------------------------------] 107/212 ( 50%) Time remaining:  3s[=====================================>------------------------------------] 108/212 ( 51%) Time remaining:  3s[=====================================>------------------------------------] 109/212 ( 51%) Time remaining:  3s[=====================================>------------------------------------] 110/212 ( 52%) Time remaining:  3s[======================================>-----------------------------------] 111/212 ( 52%) Time remaining:  3s[======================================>-----------------------------------] 112/212 ( 53%) Time remaining:  3s[======================================>-----------------------------------] 113/212 ( 53%) Time remaining:  3s[=======================================>----------------------------------] 114/212 ( 54%) Time remaining:  3s[=======================================>----------------------------------] 115/212 ( 54%) Time remaining:  3s[=======================================>----------------------------------] 116/212 ( 55%) Time remaining:  3s[========================================>---------------------------------] 117/212 ( 55%) Time remaining:  3s[========================================>---------------------------------] 118/212 ( 56%) Time remaining:  3s[=========================================>--------------------------------] 119/212 ( 56%) Time remaining:  3s[=========================================>--------------------------------] 120/212 ( 57%) Time remaining:  3s[=========================================>--------------------------------] 121/212 ( 57%) Time remaining:  3s[==========================================>-------------------------------] 122/212 ( 58%) Time remaining:  3s[==========================================>-------------------------------] 123/212 ( 58%) Time remaining:  3s[==========================================>-------------------------------] 124/212 ( 58%) Time remaining:  3s[===========================================>------------------------------] 125/212 ( 59%) Time remaining:  3s[===========================================>------------------------------] 126/212 ( 59%) Time remaining:  3s[===========================================>------------------------------] 127/212 ( 60%) Time remaining:  3s[============================================>-----------------------------] 128/212 ( 60%) Time remaining:  3s[============================================>-----------------------------] 129/212 ( 61%) Time remaining:  3s[============================================>-----------------------------] 130/212 ( 61%) Time remaining:  3s[=============================================>----------------------------] 131/212 ( 62%) Time remaining:  3s[=============================================>----------------------------] 132/212 ( 62%) Time remaining:  3s[=============================================>----------------------------] 133/212 ( 63%) Time remaining:  3s[==============================================>---------------------------] 134/212 ( 63%) Time remaining:  3s[==============================================>---------------------------] 135/212 ( 64%) Time remaining:  3s[==============================================>---------------------------] 136/212 ( 64%) Time remaining:  2s[===============================================>--------------------------] 137/212 ( 65%) Time remaining:  2s[===============================================>--------------------------] 138/212 ( 65%) Time remaining:  2s[================================================>-------------------------] 139/212 ( 66%) Time remaining:  2s[================================================>-------------------------] 140/212 ( 66%) Time remaining:  2s[================================================>-------------------------] 141/212 ( 67%) Time remaining:  2s[=================================================>------------------------] 142/212 ( 67%) Time remaining:  2s[=================================================>------------------------] 143/212 ( 67%) Time remaining:  2s[=================================================>------------------------] 144/212 ( 68%) Time remaining:  2s[==================================================>-----------------------] 145/212 ( 68%) Time remaining:  2s[==================================================>-----------------------] 146/212 ( 69%) Time remaining:  2s[==================================================>-----------------------] 147/212 ( 69%) Time remaining:  2s[===================================================>----------------------] 148/212 ( 70%) Time remaining:  2s[===================================================>----------------------] 149/212 ( 70%) Time remaining:  2s[===================================================>----------------------] 150/212 ( 71%) Time remaining:  2s[====================================================>---------------------] 151/212 ( 71%) Time remaining:  2s[====================================================>---------------------] 152/212 ( 72%) Time remaining:  2s[====================================================>---------------------] 153/212 ( 72%) Time remaining:  2s[=====================================================>--------------------] 154/212 ( 73%) Time remaining:  2s[=====================================================>--------------------] 155/212 ( 73%) Time remaining:  2s[=====================================================>--------------------] 156/212 ( 74%) Time remaining:  2s[======================================================>-------------------] 157/212 ( 74%) Time remaining:  2s[======================================================>-------------------] 158/212 ( 75%) Time remaining:  2s[=======================================================>------------------] 159/212 ( 75%) Time remaining:  2s[=======================================================>------------------] 160/212 ( 75%) Time remaining:  2s[=======================================================>------------------] 161/212 ( 76%) Time remaining:  2s[========================================================>-----------------] 162/212 ( 76%) Time remaining:  2s[========================================================>-----------------] 163/212 ( 77%) Time remaining:  2s[========================================================>-----------------] 164/212 ( 77%) Time remaining:  2s[=========================================================>----------------] 165/212 ( 78%) Time remaining:  2s[=========================================================>----------------] 166/212 ( 78%) Time remaining:  1s[=========================================================>----------------] 167/212 ( 79%) Time remaining:  1s[==========================================================>---------------] 168/212 ( 79%) Time remaining:  1s[==========================================================>---------------] 169/212 ( 80%) Time remaining:  1s[==========================================================>---------------] 170/212 ( 80%) Time remaining:  1s[===========================================================>--------------] 171/212 ( 81%) Time remaining:  1s[===========================================================>--------------] 172/212 ( 81%) Time remaining:  1s[===========================================================>--------------] 173/212 ( 82%) Time remaining:  1s[============================================================>-------------] 174/212 ( 82%) Time remaining:  1s[============================================================>-------------] 175/212 ( 83%) Time remaining:  1s[============================================================>-------------] 176/212 ( 83%) Time remaining:  1s[=============================================================>------------] 177/212 ( 83%) Time remaining:  1s[=============================================================>------------] 178/212 ( 84%) Time remaining:  1s[=============================================================>------------] 179/212 ( 84%) Time remaining:  1s[==============================================================>-----------] 180/212 ( 85%) Time remaining:  1s[==============================================================>-----------] 181/212 ( 85%) Time remaining:  1s[===============================================================>----------] 182/212 ( 86%) Time remaining:  1s[===============================================================>----------] 183/212 ( 86%) Time remaining:  1s[===============================================================>----------] 184/212 ( 87%) Time remaining:  1s[================================================================>---------] 185/212 ( 87%) Time remaining:  1s[================================================================>---------] 186/212 ( 88%) Time remaining:  1s[================================================================>---------] 187/212 ( 88%) Time remaining:  1s[=================================================================>--------] 188/212 ( 89%) Time remaining:  1s[=================================================================>--------] 189/212 ( 89%) Time remaining:  1s[=================================================================>--------] 190/212 ( 90%) Time remaining:  1s[==================================================================>-------] 191/212 ( 90%) Time remaining:  1s[==================================================================>-------] 192/212 ( 91%) Time remaining:  1s[==================================================================>-------] 193/212 ( 91%) Time remaining:  1s[===================================================================>------] 194/212 ( 92%) Time remaining:  1s[===================================================================>------] 195/212 ( 92%) Time remaining:  1s[===================================================================>------] 196/212 ( 92%) Time remaining:  1s[====================================================================>-----] 197/212 ( 93%) Time remaining:  0s[====================================================================>-----] 198/212 ( 93%) Time remaining:  0s[====================================================================>-----] 199/212 ( 94%) Time remaining:  0s[=====================================================================>----] 200/212 ( 94%) Time remaining:  0s[=====================================================================>----] 201/212 ( 95%) Time remaining:  0s[======================================================================>---] 202/212 ( 95%) Time remaining:  0s[======================================================================>---] 203/212 ( 96%) Time remaining:  0s[======================================================================>---] 204/212 ( 96%) Time remaining:  0s[=======================================================================>--] 205/212 ( 97%) Time remaining:  0s[=======================================================================>--] 206/212 ( 97%) Time remaining:  0s[=======================================================================>--] 207/212 ( 98%) Time remaining:  0s[========================================================================>-] 208/212 ( 98%) Time remaining:  0s[========================================================================>-] 209/212 ( 99%) Time remaining:  0s[========================================================================>-] 210/212 ( 99%) Time remaining:  0s[=========================================================================>] 211/212 (100%) Time remaining:  0s[==========================================================================] 212/212 (100%) Time remaining:  0s                                                                                                               

identical(new, old)
#> [1] FALSE
```

There are slight differences in the output. If no values are available
early in the patient’s course, then all stats (including length) will
now be have missing values.

``` r
new
#> # A tibble: 106 x 12
#>       id  time cr_length_06 cr_length_12 cr_max_06 cr_max_12 cr_mean_06 cr_mean_12 cr_median_06 cr_median_12
#>    <int> <dbl>        <dbl>        <dbl>     <dbl>     <dbl>      <dbl>      <dbl>        <dbl>        <dbl>
#>  1     1     0           NA           NA     NA        NA         NA         NA           NA           NA   
#>  2     1     6            3           NA      1.26     NA          1.11      NA            1.18        NA   
#>  3     1    12            1            3      1.08      1.26       1.08       1.11         1.08         1.18
#>  4     1    18            1            1      1.11      1.08       1.11       1.08         1.11         1.08
#>  5     1    24            1            1      1.21      1.11       1.21       1.11         1.21         1.11
#>  6     1    30            3            1      1.08      1.21       1.05       1.21         1.03         1.21
#>  7     1    36            2            3      1.08      1.08       1.03       1.05         1.03         1.03
#>  8     1    42            1            2      1.06      1.08       1.06       1.03         1.06         1.03
#>  9     1    48            2            1      1.20      1.06       1.15       1.06         1.15         1.06
#> 10     1    54            1            2      1.09      1.20       1.09       1.15         1.09         1.15
#> # ... with 96 more rows, and 2 more variables: cr_min_06 <dbl>, cr_min_12 <dbl>

old
#> # A tibble: 106 x 12
#>       id  time cr_length_06 cr_length_12 cr_max_06 cr_max_12 cr_mean_06 cr_mean_12 cr_median_06 cr_median_12
#>    <int> <dbl>        <dbl>        <dbl>     <dbl>     <dbl>      <dbl>      <dbl>        <dbl>        <dbl>
#>  1     1     0            0            0     NA        NA         NA         NA           NA           NA   
#>  2     1     6            3            0      1.26     NA          1.11      NA            1.18        NA   
#>  3     1    12            1            3      1.08      1.26       1.08       1.11         1.08         1.18
#>  4     1    18            1            1      1.11      1.08       1.11       1.08         1.11         1.08
#>  5     1    24            1            1      1.21      1.11       1.21       1.11         1.21         1.11
#>  6     1    30            3            1      1.08      1.21       1.05       1.21         1.03         1.21
#>  7     1    36            2            3      1.08      1.08       1.03       1.05         1.03         1.03
#>  8     1    42            1            2      1.06      1.08       1.06       1.03         1.06         1.03
#>  9     1    48            2            1      1.20      1.06       1.15       1.06         1.15         1.06
#> 10     1    54            1            2      1.09      1.20       1.09       1.15         1.09         1.15
#> # ... with 96 more rows, and 2 more variables: cr_min_06 <dbl>, cr_min_12 <dbl>
```

But the benchmarking shows that this tradeoff is worth it\! This
benchmark is even more impressive when processing multiple variables.

``` r
microbenchmark::microbenchmark(
  wf %>% 
    wiz_add_predictors(variable = 'cr',
                       lookback = lubridate::hours(12), 
                       window = lubridate::hours(6), 
                       stats = c(mean = mean,
                                 min = min,
                                 max = max,
                                 median = median,
                                 length = length),
                       output_file = FALSE),
  wf %>% 
    wiz_add_predictors_old(variable = 'cr',
                           lookback = lubridate::hours(12), 
                           window = lubridate::hours(6), 
                           stats = c(mean = mean,
                                     min = min,
                                     max = max,
                                     median = median,
                                     length = length),
                           output_file = FALSE),
  times = 1
) %>% 
  dplyr::mutate(expr = c('new', 'old'))
#> Processing variable cr...
#> Anticipated number of rows in intermediate output: 212
#> Anticipated number of rows in final output: 106
#> [===>-----------------------------------------------------------------------] 12/212 (  6%) Time remaining:  3s[====>----------------------------------------------------------------------] 13/212 (  6%) Time remaining:  3s[====>----------------------------------------------------------------------] 14/212 (  7%) Time remaining:  3s[====>----------------------------------------------------------------------] 15/212 (  7%) Time remaining:  3s[=====>---------------------------------------------------------------------] 16/212 (  8%) Time remaining:  3s[=====>---------------------------------------------------------------------] 17/212 (  8%) Time remaining:  3s[=====>---------------------------------------------------------------------] 18/212 (  8%) Time remaining:  3s[======>--------------------------------------------------------------------] 19/212 (  9%) Time remaining:  3s[======>--------------------------------------------------------------------] 20/212 (  9%) Time remaining:  3s[======>--------------------------------------------------------------------] 21/212 ( 10%) Time remaining:  3s[=======>-------------------------------------------------------------------] 22/212 ( 10%) Time remaining:  3s[=======>-------------------------------------------------------------------] 23/212 ( 11%) Time remaining:  3s[=======>-------------------------------------------------------------------] 24/212 ( 11%) Time remaining:  3s[========>------------------------------------------------------------------] 25/212 ( 12%) Time remaining:  3s[========>------------------------------------------------------------------] 26/212 ( 12%) Time remaining:  3s[=========>-----------------------------------------------------------------] 27/212 ( 13%) Time remaining:  3s[=========>-----------------------------------------------------------------] 28/212 ( 13%) Time remaining:  3s[=========>-----------------------------------------------------------------] 29/212 ( 14%) Time remaining:  3s[==========>----------------------------------------------------------------] 30/212 ( 14%) Time remaining:  3s[==========>----------------------------------------------------------------] 31/212 ( 15%) Time remaining:  3s[==========>----------------------------------------------------------------] 32/212 ( 15%) Time remaining:  3s[===========>---------------------------------------------------------------] 33/212 ( 16%) Time remaining:  3s[===========>---------------------------------------------------------------] 34/212 ( 16%) Time remaining:  3s[===========>---------------------------------------------------------------] 35/212 ( 17%) Time remaining:  3s[============>--------------------------------------------------------------] 36/212 ( 17%) Time remaining:  3s[============>--------------------------------------------------------------] 37/212 ( 17%) Time remaining:  3s[============>--------------------------------------------------------------] 38/212 ( 18%) Time remaining:  3s[=============>-------------------------------------------------------------] 39/212 ( 18%) Time remaining:  3s[=============>-------------------------------------------------------------] 40/212 ( 19%) Time remaining:  3s[==============>------------------------------------------------------------] 41/212 ( 19%) Time remaining:  3s[==============>------------------------------------------------------------] 42/212 ( 20%) Time remaining:  3s[==============>------------------------------------------------------------] 43/212 ( 20%) Time remaining:  3s[===============>-----------------------------------------------------------] 44/212 ( 21%) Time remaining:  3s[===============>-----------------------------------------------------------] 45/212 ( 21%) Time remaining:  3s[===============>-----------------------------------------------------------] 46/212 ( 22%) Time remaining:  3s[================>----------------------------------------------------------] 47/212 ( 22%) Time remaining:  3s[================>----------------------------------------------------------] 48/212 ( 23%) Time remaining:  3s[================>----------------------------------------------------------] 49/212 ( 23%) Time remaining:  3s[=================>---------------------------------------------------------] 50/212 ( 24%) Time remaining:  3s[=================>---------------------------------------------------------] 51/212 ( 24%) Time remaining:  3s[=================>---------------------------------------------------------] 52/212 ( 25%) Time remaining:  3s[==================>--------------------------------------------------------] 53/212 ( 25%) Time remaining:  3s[==================>--------------------------------------------------------] 54/212 ( 25%) Time remaining:  3s[==================>--------------------------------------------------------] 55/212 ( 26%) Time remaining:  3s[===================>-------------------------------------------------------] 56/212 ( 26%) Time remaining:  3s[===================>-------------------------------------------------------] 57/212 ( 27%) Time remaining:  3s[====================>------------------------------------------------------] 58/212 ( 27%) Time remaining:  3s[====================>------------------------------------------------------] 59/212 ( 28%) Time remaining:  3s[====================>------------------------------------------------------] 60/212 ( 28%) Time remaining:  3s[=====================>-----------------------------------------------------] 61/212 ( 29%) Time remaining:  3s[=====================>-----------------------------------------------------] 62/212 ( 29%) Time remaining:  3s[=====================>-----------------------------------------------------] 63/212 ( 30%) Time remaining:  3s[======================>----------------------------------------------------] 64/212 ( 30%) Time remaining:  3s[======================>----------------------------------------------------] 65/212 ( 31%) Time remaining:  3s[======================>----------------------------------------------------] 66/212 ( 31%) Time remaining:  3s[=======================>---------------------------------------------------] 67/212 ( 32%) Time remaining:  2s[=======================>---------------------------------------------------] 68/212 ( 32%) Time remaining:  2s[=======================>---------------------------------------------------] 69/212 ( 33%) Time remaining:  2s[========================>--------------------------------------------------] 70/212 ( 33%) Time remaining:  2s[========================>--------------------------------------------------] 71/212 ( 33%) Time remaining:  2s[========================>--------------------------------------------------] 72/212 ( 34%) Time remaining:  2s[=========================>-------------------------------------------------] 73/212 ( 34%) Time remaining:  2s[=========================>-------------------------------------------------] 74/212 ( 35%) Time remaining:  2s[==========================>------------------------------------------------] 75/212 ( 35%) Time remaining:  2s[==========================>------------------------------------------------] 76/212 ( 36%) Time remaining:  2s[==========================>------------------------------------------------] 77/212 ( 36%) Time remaining:  2s[===========================>-----------------------------------------------] 78/212 ( 37%) Time remaining:  2s[===========================>-----------------------------------------------] 79/212 ( 37%) Time remaining:  2s[===========================>-----------------------------------------------] 80/212 ( 38%) Time remaining:  2s[============================>----------------------------------------------] 81/212 ( 38%) Time remaining:  2s[============================>----------------------------------------------] 82/212 ( 39%) Time remaining:  2s[============================>----------------------------------------------] 83/212 ( 39%) Time remaining:  2s[=============================>---------------------------------------------] 84/212 ( 40%) Time remaining:  2s[=============================>---------------------------------------------] 85/212 ( 40%) Time remaining:  2s[=============================>---------------------------------------------] 86/212 ( 41%) Time remaining:  2s[==============================>--------------------------------------------] 87/212 ( 41%) Time remaining:  2s[==============================>--------------------------------------------] 88/212 ( 42%) Time remaining:  2s[==============================>--------------------------------------------] 89/212 ( 42%) Time remaining:  2s[===============================>-------------------------------------------] 90/212 ( 42%) Time remaining:  2s[===============================>-------------------------------------------] 91/212 ( 43%) Time remaining:  2s[================================>------------------------------------------] 92/212 ( 43%) Time remaining:  2s[================================>------------------------------------------] 93/212 ( 44%) Time remaining:  2s[================================>------------------------------------------] 94/212 ( 44%) Time remaining:  2s[=================================>-----------------------------------------] 95/212 ( 45%) Time remaining:  2s[=================================>-----------------------------------------] 96/212 ( 45%) Time remaining:  2s[=================================>-----------------------------------------] 97/212 ( 46%) Time remaining:  2s[==================================>----------------------------------------] 98/212 ( 46%) Time remaining:  2s[==================================>----------------------------------------] 99/212 ( 47%) Time remaining:  2s[==================================>---------------------------------------] 100/212 ( 47%) Time remaining:  2s[==================================>---------------------------------------] 101/212 ( 48%) Time remaining:  2s[===================================>--------------------------------------] 102/212 ( 48%) Time remaining:  2s[===================================>--------------------------------------] 103/212 ( 49%) Time remaining:  2s[===================================>--------------------------------------] 104/212 ( 49%) Time remaining:  2s[====================================>-------------------------------------] 105/212 ( 50%) Time remaining:  2s[====================================>-------------------------------------] 106/212 ( 50%) Time remaining:  2s[====================================>-------------------------------------] 107/212 ( 50%) Time remaining:  2s[=====================================>------------------------------------] 108/212 ( 51%) Time remaining:  2s[=====================================>------------------------------------] 109/212 ( 51%) Time remaining:  2s[=====================================>------------------------------------] 110/212 ( 52%) Time remaining:  2s[======================================>-----------------------------------] 111/212 ( 52%) Time remaining:  2s[======================================>-----------------------------------] 112/212 ( 53%) Time remaining:  2s[======================================>-----------------------------------] 113/212 ( 53%) Time remaining:  2s[=======================================>----------------------------------] 114/212 ( 54%) Time remaining:  2s[=======================================>----------------------------------] 115/212 ( 54%) Time remaining:  2s[=======================================>----------------------------------] 116/212 ( 55%) Time remaining:  2s[========================================>---------------------------------] 117/212 ( 55%) Time remaining:  2s[========================================>---------------------------------] 118/212 ( 56%) Time remaining:  2s[=========================================>--------------------------------] 119/212 ( 56%) Time remaining:  2s[=========================================>--------------------------------] 120/212 ( 57%) Time remaining:  2s[=========================================>--------------------------------] 121/212 ( 57%) Time remaining:  2s[==========================================>-------------------------------] 122/212 ( 58%) Time remaining:  2s[==========================================>-------------------------------] 123/212 ( 58%) Time remaining:  2s[==========================================>-------------------------------] 124/212 ( 58%) Time remaining:  2s[===========================================>------------------------------] 125/212 ( 59%) Time remaining:  1s[===========================================>------------------------------] 126/212 ( 59%) Time remaining:  1s[===========================================>------------------------------] 127/212 ( 60%) Time remaining:  1s[============================================>-----------------------------] 128/212 ( 60%) Time remaining:  1s[============================================>-----------------------------] 129/212 ( 61%) Time remaining:  1s[============================================>-----------------------------] 130/212 ( 61%) Time remaining:  1s[=============================================>----------------------------] 131/212 ( 62%) Time remaining:  1s[=============================================>----------------------------] 132/212 ( 62%) Time remaining:  1s[=============================================>----------------------------] 133/212 ( 63%) Time remaining:  1s[==============================================>---------------------------] 134/212 ( 63%) Time remaining:  1s[==============================================>---------------------------] 135/212 ( 64%) Time remaining:  1s[==============================================>---------------------------] 136/212 ( 64%) Time remaining:  1s[===============================================>--------------------------] 137/212 ( 65%) Time remaining:  1s[===============================================>--------------------------] 138/212 ( 65%) Time remaining:  1s[================================================>-------------------------] 139/212 ( 66%) Time remaining:  1s[================================================>-------------------------] 140/212 ( 66%) Time remaining:  1s[================================================>-------------------------] 141/212 ( 67%) Time remaining:  1s[=================================================>------------------------] 142/212 ( 67%) Time remaining:  1s[=================================================>------------------------] 143/212 ( 67%) Time remaining:  1s[=================================================>------------------------] 144/212 ( 68%) Time remaining:  1s[==================================================>-----------------------] 145/212 ( 68%) Time remaining:  1s[==================================================>-----------------------] 146/212 ( 69%) Time remaining:  1s[==================================================>-----------------------] 147/212 ( 69%) Time remaining:  1s[===================================================>----------------------] 148/212 ( 70%) Time remaining:  1s[===================================================>----------------------] 149/212 ( 70%) Time remaining:  1s[===================================================>----------------------] 150/212 ( 71%) Time remaining:  1s[====================================================>---------------------] 151/212 ( 71%) Time remaining:  1s[====================================================>---------------------] 152/212 ( 72%) Time remaining:  1s[====================================================>---------------------] 153/212 ( 72%) Time remaining:  1s[=====================================================>--------------------] 154/212 ( 73%) Time remaining:  1s[=====================================================>--------------------] 155/212 ( 73%) Time remaining:  1s[=====================================================>--------------------] 156/212 ( 74%) Time remaining:  1s[======================================================>-------------------] 157/212 ( 74%) Time remaining:  1s[======================================================>-------------------] 158/212 ( 75%) Time remaining:  1s[=======================================================>------------------] 159/212 ( 75%) Time remaining:  1s[=======================================================>------------------] 160/212 ( 75%) Time remaining:  1s[=======================================================>------------------] 161/212 ( 76%) Time remaining:  1s[========================================================>-----------------] 162/212 ( 76%) Time remaining:  1s[========================================================>-----------------] 163/212 ( 77%) Time remaining:  1s[========================================================>-----------------] 164/212 ( 77%) Time remaining:  1s[=========================================================>----------------] 165/212 ( 78%) Time remaining:  1s[=========================================================>----------------] 166/212 ( 78%) Time remaining:  1s[=========================================================>----------------] 167/212 ( 79%) Time remaining:  1s[==========================================================>---------------] 168/212 ( 79%) Time remaining:  1s[==========================================================>---------------] 169/212 ( 80%) Time remaining:  1s[==========================================================>---------------] 170/212 ( 80%) Time remaining:  1s[===========================================================>--------------] 171/212 ( 81%) Time remaining:  1s[===========================================================>--------------] 172/212 ( 81%) Time remaining:  1s[===========================================================>--------------] 173/212 ( 82%) Time remaining:  1s[============================================================>-------------] 174/212 ( 82%) Time remaining:  1s[============================================================>-------------] 175/212 ( 83%) Time remaining:  1s[============================================================>-------------] 176/212 ( 83%) Time remaining:  1s[=============================================================>------------] 177/212 ( 83%) Time remaining:  1s[=============================================================>------------] 178/212 ( 84%) Time remaining:  1s[=============================================================>------------] 179/212 ( 84%) Time remaining:  1s[==============================================================>-----------] 180/212 ( 85%) Time remaining:  1s[==============================================================>-----------] 181/212 ( 85%) Time remaining:  1s[===============================================================>----------] 182/212 ( 86%) Time remaining:  1s[===============================================================>----------] 183/212 ( 86%) Time remaining:  0s[===============================================================>----------] 184/212 ( 87%) Time remaining:  0s[================================================================>---------] 185/212 ( 87%) Time remaining:  0s[================================================================>---------] 186/212 ( 88%) Time remaining:  0s[================================================================>---------] 187/212 ( 88%) Time remaining:  0s[=================================================================>--------] 188/212 ( 89%) Time remaining:  0s[=================================================================>--------] 189/212 ( 89%) Time remaining:  0s[=================================================================>--------] 190/212 ( 90%) Time remaining:  0s[==================================================================>-------] 191/212 ( 90%) Time remaining:  0s[==================================================================>-------] 192/212 ( 91%) Time remaining:  0s[==================================================================>-------] 193/212 ( 91%) Time remaining:  0s[===================================================================>------] 194/212 ( 92%) Time remaining:  0s[===================================================================>------] 195/212 ( 92%) Time remaining:  0s[===================================================================>------] 196/212 ( 92%) Time remaining:  0s[====================================================================>-----] 197/212 ( 93%) Time remaining:  0s[====================================================================>-----] 198/212 ( 93%) Time remaining:  0s[====================================================================>-----] 199/212 ( 94%) Time remaining:  0s[=====================================================================>----] 200/212 ( 94%) Time remaining:  0s[=====================================================================>----] 201/212 ( 95%) Time remaining:  0s[======================================================================>---] 202/212 ( 95%) Time remaining:  0s[======================================================================>---] 203/212 ( 96%) Time remaining:  0s[======================================================================>---] 204/212 ( 96%) Time remaining:  0s[=======================================================================>--] 205/212 ( 97%) Time remaining:  0s[=======================================================================>--] 206/212 ( 97%) Time remaining:  0s[=======================================================================>--] 207/212 ( 98%) Time remaining:  0s[========================================================================>-] 208/212 ( 98%) Time remaining:  0s[========================================================================>-] 209/212 ( 99%) Time remaining:  0s[========================================================================>-] 210/212 ( 99%) Time remaining:  0s[=========================================================================>] 211/212 (100%) Time remaining:  0s[==========================================================================] 212/212 (100%) Time remaining:  0s                                                                                                               Processing variable cr...
#> Anticipated number of rows in intermediate output: 212
#> Anticipated number of rows in final output: 106
#> Number of ids to process: 2
#> [==>-------------------------------------------------------------------------] 7/212 (  3%) Time remaining:  6s[==>-------------------------------------------------------------------------] 8/212 (  4%) Time remaining:  6s[==>-------------------------------------------------------------------------] 9/212 (  4%) Time remaining:  6s[===>-----------------------------------------------------------------------] 10/212 (  5%) Time remaining:  6s[===>-----------------------------------------------------------------------] 11/212 (  5%) Time remaining:  6s[===>-----------------------------------------------------------------------] 12/212 (  6%) Time remaining:  6s[====>----------------------------------------------------------------------] 13/212 (  6%) Time remaining:  6s[====>----------------------------------------------------------------------] 14/212 (  7%) Time remaining:  6s[====>----------------------------------------------------------------------] 15/212 (  7%) Time remaining:  6s[=====>---------------------------------------------------------------------] 16/212 (  8%) Time remaining:  6s[=====>---------------------------------------------------------------------] 17/212 (  8%) Time remaining:  6s[=====>---------------------------------------------------------------------] 18/212 (  8%) Time remaining:  6s[======>--------------------------------------------------------------------] 19/212 (  9%) Time remaining:  6s[======>--------------------------------------------------------------------] 20/212 (  9%) Time remaining:  6s[======>--------------------------------------------------------------------] 21/212 ( 10%) Time remaining:  6s[=======>-------------------------------------------------------------------] 22/212 ( 10%) Time remaining:  6s[=======>-------------------------------------------------------------------] 23/212 ( 11%) Time remaining:  6s[=======>-------------------------------------------------------------------] 24/212 ( 11%) Time remaining:  6s[========>------------------------------------------------------------------] 25/212 ( 12%) Time remaining:  6s[========>------------------------------------------------------------------] 26/212 ( 12%) Time remaining:  6s[=========>-----------------------------------------------------------------] 27/212 ( 13%) Time remaining:  6s[=========>-----------------------------------------------------------------] 28/212 ( 13%) Time remaining:  6s[=========>-----------------------------------------------------------------] 29/212 ( 14%) Time remaining:  6s[==========>----------------------------------------------------------------] 30/212 ( 14%) Time remaining:  5s[==========>----------------------------------------------------------------] 31/212 ( 15%) Time remaining:  5s[==========>----------------------------------------------------------------] 32/212 ( 15%) Time remaining:  5s[===========>---------------------------------------------------------------] 33/212 ( 16%) Time remaining:  5s[===========>---------------------------------------------------------------] 34/212 ( 16%) Time remaining:  5s[===========>---------------------------------------------------------------] 35/212 ( 17%) Time remaining:  5s[============>--------------------------------------------------------------] 36/212 ( 17%) Time remaining:  5s[============>--------------------------------------------------------------] 37/212 ( 17%) Time remaining:  5s[============>--------------------------------------------------------------] 38/212 ( 18%) Time remaining:  5s[=============>-------------------------------------------------------------] 39/212 ( 18%) Time remaining:  5s[=============>-------------------------------------------------------------] 40/212 ( 19%) Time remaining:  5s[==============>------------------------------------------------------------] 41/212 ( 19%) Time remaining:  5s[==============>------------------------------------------------------------] 42/212 ( 20%) Time remaining:  5s[==============>------------------------------------------------------------] 43/212 ( 20%) Time remaining:  5s[===============>-----------------------------------------------------------] 44/212 ( 21%) Time remaining:  5s[===============>-----------------------------------------------------------] 45/212 ( 21%) Time remaining:  5s[===============>-----------------------------------------------------------] 46/212 ( 22%) Time remaining:  5s[================>----------------------------------------------------------] 47/212 ( 22%) Time remaining:  5s[================>----------------------------------------------------------] 48/212 ( 23%) Time remaining:  5s[================>----------------------------------------------------------] 49/212 ( 23%) Time remaining:  5s[=================>---------------------------------------------------------] 50/212 ( 24%) Time remaining:  5s[=================>---------------------------------------------------------] 51/212 ( 24%) Time remaining:  5s[=================>---------------------------------------------------------] 52/212 ( 25%) Time remaining:  5s[==================>--------------------------------------------------------] 53/212 ( 25%) Time remaining:  5s[==================>--------------------------------------------------------] 54/212 ( 25%) Time remaining:  5s[==================>--------------------------------------------------------] 55/212 ( 26%) Time remaining:  5s[===================>-------------------------------------------------------] 56/212 ( 26%) Time remaining:  5s[===================>-------------------------------------------------------] 57/212 ( 27%) Time remaining:  5s[====================>------------------------------------------------------] 58/212 ( 27%) Time remaining:  5s[====================>------------------------------------------------------] 59/212 ( 28%) Time remaining:  5s[====================>------------------------------------------------------] 60/212 ( 28%) Time remaining:  5s[=====================>-----------------------------------------------------] 61/212 ( 29%) Time remaining:  5s[=====================>-----------------------------------------------------] 62/212 ( 29%) Time remaining:  5s[=====================>-----------------------------------------------------] 63/212 ( 30%) Time remaining:  4s[======================>----------------------------------------------------] 64/212 ( 30%) Time remaining:  4s[======================>----------------------------------------------------] 65/212 ( 31%) Time remaining:  4s[======================>----------------------------------------------------] 66/212 ( 31%) Time remaining:  4s[=======================>---------------------------------------------------] 67/212 ( 32%) Time remaining:  4s[=======================>---------------------------------------------------] 68/212 ( 32%) Time remaining:  4s[=======================>---------------------------------------------------] 69/212 ( 33%) Time remaining:  4s[========================>--------------------------------------------------] 70/212 ( 33%) Time remaining:  4s[========================>--------------------------------------------------] 71/212 ( 33%) Time remaining:  4s[========================>--------------------------------------------------] 72/212 ( 34%) Time remaining:  4s[=========================>-------------------------------------------------] 73/212 ( 34%) Time remaining:  4s[=========================>-------------------------------------------------] 74/212 ( 35%) Time remaining:  4s[==========================>------------------------------------------------] 75/212 ( 35%) Time remaining:  4s[==========================>------------------------------------------------] 76/212 ( 36%) Time remaining:  4s[==========================>------------------------------------------------] 77/212 ( 36%) Time remaining:  4s[===========================>-----------------------------------------------] 78/212 ( 37%) Time remaining:  4s[===========================>-----------------------------------------------] 79/212 ( 37%) Time remaining:  4s[===========================>-----------------------------------------------] 80/212 ( 38%) Time remaining:  4s[============================>----------------------------------------------] 81/212 ( 38%) Time remaining:  4s[============================>----------------------------------------------] 82/212 ( 39%) Time remaining:  4s[============================>----------------------------------------------] 83/212 ( 39%) Time remaining:  4s[=============================>---------------------------------------------] 84/212 ( 40%) Time remaining:  4s[=============================>---------------------------------------------] 85/212 ( 40%) Time remaining:  4s[=============================>---------------------------------------------] 86/212 ( 41%) Time remaining:  4s[==============================>--------------------------------------------] 87/212 ( 41%) Time remaining:  4s[==============================>--------------------------------------------] 88/212 ( 42%) Time remaining:  4s[==============================>--------------------------------------------] 89/212 ( 42%) Time remaining:  4s[===============================>-------------------------------------------] 90/212 ( 42%) Time remaining:  4s[===============================>-------------------------------------------] 91/212 ( 43%) Time remaining:  4s[================================>------------------------------------------] 92/212 ( 43%) Time remaining:  4s[================================>------------------------------------------] 93/212 ( 44%) Time remaining:  4s[================================>------------------------------------------] 94/212 ( 44%) Time remaining:  4s[=================================>-----------------------------------------] 95/212 ( 45%) Time remaining:  4s[=================================>-----------------------------------------] 96/212 ( 45%) Time remaining:  4s[=================================>-----------------------------------------] 97/212 ( 46%) Time remaining:  3s[==================================>----------------------------------------] 98/212 ( 46%) Time remaining:  3s[==================================>----------------------------------------] 99/212 ( 47%) Time remaining:  3s[==================================>---------------------------------------] 100/212 ( 47%) Time remaining:  3s[==================================>---------------------------------------] 101/212 ( 48%) Time remaining:  3s[===================================>--------------------------------------] 102/212 ( 48%) Time remaining:  3s[===================================>--------------------------------------] 103/212 ( 49%) Time remaining:  3s[===================================>--------------------------------------] 104/212 ( 49%) Time remaining:  3s[====================================>-------------------------------------] 105/212 ( 50%) Time remaining:  3s[====================================>-------------------------------------] 106/212 ( 50%) Time remaining:  3s[====================================>-------------------------------------] 107/212 ( 50%) Time remaining:  3s[=====================================>------------------------------------] 108/212 ( 51%) Time remaining:  3s[=====================================>------------------------------------] 109/212 ( 51%) Time remaining:  3s[=====================================>------------------------------------] 110/212 ( 52%) Time remaining:  3s[======================================>-----------------------------------] 111/212 ( 52%) Time remaining:  3s[======================================>-----------------------------------] 112/212 ( 53%) Time remaining:  3s[======================================>-----------------------------------] 113/212 ( 53%) Time remaining:  3s[=======================================>----------------------------------] 114/212 ( 54%) Time remaining:  3s[=======================================>----------------------------------] 115/212 ( 54%) Time remaining:  3s[=======================================>----------------------------------] 116/212 ( 55%) Time remaining:  3s[========================================>---------------------------------] 117/212 ( 55%) Time remaining:  3s[========================================>---------------------------------] 118/212 ( 56%) Time remaining:  3s[=========================================>--------------------------------] 119/212 ( 56%) Time remaining:  3s[=========================================>--------------------------------] 120/212 ( 57%) Time remaining:  3s[=========================================>--------------------------------] 121/212 ( 57%) Time remaining:  3s[==========================================>-------------------------------] 122/212 ( 58%) Time remaining:  3s[==========================================>-------------------------------] 123/212 ( 58%) Time remaining:  3s[==========================================>-------------------------------] 124/212 ( 58%) Time remaining:  3s[===========================================>------------------------------] 125/212 ( 59%) Time remaining:  3s[===========================================>------------------------------] 126/212 ( 59%) Time remaining:  3s[===========================================>------------------------------] 127/212 ( 60%) Time remaining:  3s[============================================>-----------------------------] 128/212 ( 60%) Time remaining:  3s[============================================>-----------------------------] 129/212 ( 61%) Time remaining:  3s[============================================>-----------------------------] 130/212 ( 61%) Time remaining:  3s[=============================================>----------------------------] 131/212 ( 62%) Time remaining:  2s[=============================================>----------------------------] 132/212 ( 62%) Time remaining:  2s[=============================================>----------------------------] 133/212 ( 63%) Time remaining:  2s[==============================================>---------------------------] 134/212 ( 63%) Time remaining:  2s[==============================================>---------------------------] 135/212 ( 64%) Time remaining:  2s[==============================================>---------------------------] 136/212 ( 64%) Time remaining:  2s[===============================================>--------------------------] 137/212 ( 65%) Time remaining:  2s[===============================================>--------------------------] 138/212 ( 65%) Time remaining:  2s[================================================>-------------------------] 139/212 ( 66%) Time remaining:  2s[================================================>-------------------------] 140/212 ( 66%) Time remaining:  2s[================================================>-------------------------] 141/212 ( 67%) Time remaining:  2s[=================================================>------------------------] 142/212 ( 67%) Time remaining:  2s[=================================================>------------------------] 143/212 ( 67%) Time remaining:  2s[=================================================>------------------------] 144/212 ( 68%) Time remaining:  2s[==================================================>-----------------------] 145/212 ( 68%) Time remaining:  2s[==================================================>-----------------------] 146/212 ( 69%) Time remaining:  2s[==================================================>-----------------------] 147/212 ( 69%) Time remaining:  2s[===================================================>----------------------] 148/212 ( 70%) Time remaining:  2s[===================================================>----------------------] 149/212 ( 70%) Time remaining:  2s[===================================================>----------------------] 150/212 ( 71%) Time remaining:  2s[====================================================>---------------------] 151/212 ( 71%) Time remaining:  2s[====================================================>---------------------] 152/212 ( 72%) Time remaining:  2s[====================================================>---------------------] 153/212 ( 72%) Time remaining:  2s[=====================================================>--------------------] 154/212 ( 73%) Time remaining:  2s[=====================================================>--------------------] 155/212 ( 73%) Time remaining:  2s[=====================================================>--------------------] 156/212 ( 74%) Time remaining:  2s[======================================================>-------------------] 157/212 ( 74%) Time remaining:  2s[======================================================>-------------------] 158/212 ( 75%) Time remaining:  2s[=======================================================>------------------] 159/212 ( 75%) Time remaining:  2s[=======================================================>------------------] 160/212 ( 75%) Time remaining:  2s[=======================================================>------------------] 161/212 ( 76%) Time remaining:  2s[========================================================>-----------------] 162/212 ( 76%) Time remaining:  2s[========================================================>-----------------] 163/212 ( 77%) Time remaining:  1s[========================================================>-----------------] 164/212 ( 77%) Time remaining:  1s[=========================================================>----------------] 165/212 ( 78%) Time remaining:  1s[=========================================================>----------------] 166/212 ( 78%) Time remaining:  1s[=========================================================>----------------] 167/212 ( 79%) Time remaining:  1s[==========================================================>---------------] 168/212 ( 79%) Time remaining:  1s[==========================================================>---------------] 169/212 ( 80%) Time remaining:  1s[==========================================================>---------------] 170/212 ( 80%) Time remaining:  1s[===========================================================>--------------] 171/212 ( 81%) Time remaining:  1s[===========================================================>--------------] 172/212 ( 81%) Time remaining:  1s[===========================================================>--------------] 173/212 ( 82%) Time remaining:  1s[============================================================>-------------] 174/212 ( 82%) Time remaining:  1s[============================================================>-------------] 175/212 ( 83%) Time remaining:  1s[============================================================>-------------] 176/212 ( 83%) Time remaining:  1s[=============================================================>------------] 177/212 ( 83%) Time remaining:  1s[=============================================================>------------] 178/212 ( 84%) Time remaining:  1s[=============================================================>------------] 179/212 ( 84%) Time remaining:  1s[==============================================================>-----------] 180/212 ( 85%) Time remaining:  1s[==============================================================>-----------] 181/212 ( 85%) Time remaining:  1s[===============================================================>----------] 182/212 ( 86%) Time remaining:  1s[===============================================================>----------] 183/212 ( 86%) Time remaining:  1s[===============================================================>----------] 184/212 ( 87%) Time remaining:  1s[================================================================>---------] 185/212 ( 87%) Time remaining:  1s[================================================================>---------] 186/212 ( 88%) Time remaining:  1s[================================================================>---------] 187/212 ( 88%) Time remaining:  1s[=================================================================>--------] 188/212 ( 89%) Time remaining:  1s[=================================================================>--------] 189/212 ( 89%) Time remaining:  1s[=================================================================>--------] 190/212 ( 90%) Time remaining:  1s[==================================================================>-------] 191/212 ( 90%) Time remaining:  1s[==================================================================>-------] 192/212 ( 91%) Time remaining:  1s[==================================================================>-------] 193/212 ( 91%) Time remaining:  1s[===================================================================>------] 194/212 ( 92%) Time remaining:  1s[===================================================================>------] 195/212 ( 92%) Time remaining:  1s[===================================================================>------] 196/212 ( 92%) Time remaining:  0s[====================================================================>-----] 197/212 ( 93%) Time remaining:  0s[====================================================================>-----] 198/212 ( 93%) Time remaining:  0s[====================================================================>-----] 199/212 ( 94%) Time remaining:  0s[=====================================================================>----] 200/212 ( 94%) Time remaining:  0s[=====================================================================>----] 201/212 ( 95%) Time remaining:  0s[======================================================================>---] 202/212 ( 95%) Time remaining:  0s[======================================================================>---] 203/212 ( 96%) Time remaining:  0s[======================================================================>---] 204/212 ( 96%) Time remaining:  0s[=======================================================================>--] 205/212 ( 97%) Time remaining:  0s[=======================================================================>--] 206/212 ( 97%) Time remaining:  0s[=======================================================================>--] 207/212 ( 98%) Time remaining:  0s[========================================================================>-] 208/212 ( 98%) Time remaining:  0s[========================================================================>-] 209/212 ( 99%) Time remaining:  0s[========================================================================>-] 210/212 ( 99%) Time remaining:  0s[=========================================================================>] 211/212 (100%) Time remaining:  0s[==========================================================================] 212/212 (100%) Time remaining:  0s                                                                                                               
#> Unit: seconds
#>  expr      min       lq     mean   median       uq      max neval
#>   new 3.708464 3.708464 3.708464 3.708464 3.708464 3.708464     1
#>   old 6.553989 6.553989 6.553989 6.553989 6.553989 6.553989     1
```
